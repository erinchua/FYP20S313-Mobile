{"ast":null,"code":"import _objectSpread from\"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import{IonAlert,IonButton,IonCol,IonContent,IonGrid,IonItemDivider,IonLabel,IonLoading,IonModal,IonRow,IonTextarea}from'@ionic/react';import React,{useEffect,useState}from'react';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faCommentDots,faEdit}from'@fortawesome/free-regular-svg-icons';import{faTrash}from'@fortawesome/free-solid-svg-icons';import\"../../css/Global.css\";import\"../../css/Forum.css\";import{db}from'../../firebase';import{useAuth}from'../../modules/auth';var ForumQuestions=function ForumQuestions(props){var _useAuth=useAuth(),userID=_useAuth.userID;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showEditCommentModal=_useState4[0],setShowEditCommentModal=_useState4[1];var _useState5=useState({alert:false,loading:false}),_useState6=_slicedToArray(_useState5,2),deleteAlert=_useState6[0],setDeleteAlert=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),comments=_useState8[0],setComments=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),entry=_useState10[0],setEntry=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),toBeEdited=_useState12[0],setToBeEdited=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),toBeDeleted=_useState14[0],setToBeDeleted=_useState14[1];var handleDelete=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(postId){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setDeleteAlert({alert:false,loading:true});_context.next=4;return db.collection('Forum').doc(userID).collection('Comments').doc(postId).update({deleted:true});case 4:_context.next=9;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);return _context.abrupt(\"return\",console.log(_context.t0));case 9:_context.prev=9;setDeleteAlert({alert:false,loading:false});return _context.finish(9);case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,6,9,12]]);}));return function handleDelete(_x){return _ref.apply(this,arguments);};}();var handleEdit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(postId){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setLoading(true);_context2.next=4;return db.collection('Forum').doc(userID).collection('Comments').doc(postId).update({entry:entry});case 4:_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);return _context2.abrupt(\"return\",console.log(_context2.t0));case 9:_context2.prev=9;setShowEditCommentModal(false);setLoading(false);setEntry(\"\");return _context2.finish(9);case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6,9,14]]);}));return function handleEdit(_x2){return _ref2.apply(this,arguments);};}();useEffect(function(){return db.collection('Forum').doc(userID).collection('Comments').where(\"deleted\",\"==\",false).onSnapshot(function(snaps){var posts=[];snaps.forEach(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(snap){var post;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:post=_objectSpread({},snap.data());_context3.next=3;return db.collection('Forum').get().then(function(users){users.forEach(function(user){return db.collection('Forum').doc(user.id).collection('Questions').doc(snap.data().questionId.toString()).onSnapshot(function(question){if(question.exists){var _question$data,_question$data2;post.question=(_question$data=question.data())===null||_question$data===void 0?void 0:_question$data.entry;post.questionRemoved=(_question$data2=question.data())===null||_question$data2===void 0?void 0:_question$data2.deleted;}});});});case 3:posts.push(post);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}());setTimeout(function(){setComments(posts);setLoading(false);},500);});},[]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(IonGrid,{id:\"forumQnsCom-tableGrid\"},/*#__PURE__*/React.createElement(IonRow,{id:\"forumQnsCom-tableHeader\",className:\"ion-justify-content-center\"},/*#__PURE__*/React.createElement(IonCol,{className:\"forumQnsCom-Header ion-text-wrap\"},\"Question\"),/*#__PURE__*/React.createElement(IonCol,{className:\"forumQnsCom-Header ion-text-wrap\"},\"My Comment\"),/*#__PURE__*/React.createElement(IonCol,{className:\"forumQnsCom-Header ion-text-wrap\"},\"Posted Date/Time\"),/*#__PURE__*/React.createElement(IonCol,{className:\"forumQnsCom-Header ion-text-wrap\"},/*#__PURE__*/React.createElement(IonRow,{className:\"ion-justify-content-center\"},\"No. of\"),/*#__PURE__*/React.createElement(IonRow,{className:\"ion-justify-content-center\"},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faCommentDots,size:\"lg\"}))),/*#__PURE__*/React.createElement(IonCol,{className:\"forumQnsCom-Header ion-text-wrap\"},\"Edit Comment\"),/*#__PURE__*/React.createElement(IonCol,{className:\"forumQnsCom-Header ion-text-wrap\"},\"Delete Comment\")),comments.map(function(post){return/*#__PURE__*/React.createElement(IonRow,{className:\"ion-justify-content-center\",key:post.id},/*#__PURE__*/React.createElement(IonCol,{className:\"forumQnsCom-Data ion-text-wrap\"},post.questionRemoved===false?post.question:\"[deleted]\"),/*#__PURE__*/React.createElement(IonCol,{className:\"forumQnsCom-Data ion-text-wrap\"},post.entry),/*#__PURE__*/React.createElement(IonCol,{className:\"forumQnsCom-Data ion-text-wrap\"},post.dateTime),/*#__PURE__*/React.createElement(IonCol,{className:\"forumQnsCom-Data ion-text-wrap\"},post.hasOwnProperty('commentId')===false?post.noOfReplies:\"-\"),/*#__PURE__*/React.createElement(IonCol,{className:\"forumQnsCom-Data ion-text-wrap\"},/*#__PURE__*/React.createElement(IonButton,{onClick:function onClick(){return[setShowEditCommentModal(true),setToBeEdited(post.id)];},className:\"forumQnsCom-DataBtn\",size:\"small\",style:{marginTop:\"-5%\",marginBottom:\"-5%\"}},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faEdit,size:\"lg\"}))),/*#__PURE__*/React.createElement(IonCol,{className:\"forumQnsCom-Data ion-text-wrap\"},/*#__PURE__*/React.createElement(IonButton,{onClick:function onClick(){return[setDeleteAlert({alert:true,loading:false}),setToBeDeleted(post.id)];},className:\"forumQnsCom-DataBtn\",size:\"small\",style:{marginTop:\"-5%\",marginBottom:\"-5%\"}},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faTrash,size:\"lg\"}))));})),/*#__PURE__*/React.createElement(IonModal,{isOpen:showEditCommentModal,cssClass:\"post-question-modal\",onDidDismiss:function onDidDismiss(){return setShowEditCommentModal(false);}},/*#__PURE__*/React.createElement(IonContent,null,/*#__PURE__*/React.createElement(IonGrid,{id:\"postQns-modal-container\"},/*#__PURE__*/React.createElement(IonRow,{style:{paddingTop:'1%'}},/*#__PURE__*/React.createElement(IonLabel,{id:\"postQns-title\"},\"Edit Comment\")),/*#__PURE__*/React.createElement(IonItemDivider,null),/*#__PURE__*/React.createElement(IonRow,{id:\"postQns-modal-inputArea\"},/*#__PURE__*/React.createElement(IonTextarea,{rows:11,contentEditable:true,value:entry,onIonChange:function onIonChange(e){return setEntry(e.detail.value);},required:true})),/*#__PURE__*/React.createElement(IonRow,{className:\"ion-justify-content-around\"},/*#__PURE__*/React.createElement(IonButton,{id:\"postQns-close-button\",fill:\"outline\",onClick:function onClick(){return setShowEditCommentModal(false);}},\"CANCEL\"),/*#__PURE__*/React.createElement(IonButton,{id:\"postQns-post-button\",onClick:function onClick(){return handleEdit(toBeEdited.toString());}},\"UPDATE\"))))),/*#__PURE__*/React.createElement(IonAlert,{isOpen:deleteAlert.alert,cssClass:\"alertBox\",header:'Delete Comment',message:'Are you sure you want to delete the comment?',buttons:[{text:'NO',handler:function handler(){return setDeleteAlert({alert:false,loading:false});}},{text:'YES',handler:function handler(){return handleDelete(toBeDeleted.toString());}}]}),/*#__PURE__*/React.createElement(IonLoading,{isOpen:deleteAlert.loading||loading}));};export default ForumQuestions;","map":{"version":3,"sources":["D:/BearBear/Coding_Projects/UOW-CSIT321 (FYP)/FYP20S313-Mobile/SIM-OpenHouse/src/components/Forum/ForumComments.tsx"],"names":["IonAlert","IonButton","IonCol","IonContent","IonGrid","IonItemDivider","IonLabel","IonLoading","IonModal","IonRow","IonTextarea","React","useEffect","useState","FontAwesomeIcon","faCommentDots","faEdit","faTrash","db","useAuth","ForumQuestions","props","userID","loading","setLoading","showEditCommentModal","setShowEditCommentModal","alert","deleteAlert","setDeleteAlert","comments","setComments","entry","setEntry","toBeEdited","setToBeEdited","toBeDeleted","setToBeDeleted","handleDelete","postId","collection","doc","update","deleted","console","log","handleEdit","where","onSnapshot","snaps","posts","forEach","snap","post","data","get","then","users","user","id","questionId","toString","question","exists","questionRemoved","push","setTimeout","map","dateTime","hasOwnProperty","noOfReplies","marginTop","marginBottom","paddingTop","e","detail","value","text","handler"],"mappings":"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","sourcesContent":["import { IonAlert, IonButton, IonCol, IonContent, IonGrid, IonItemDivider, IonLabel, IonLoading, IonModal, IonRow, IonTextarea } from '@ionic/react';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faCommentDots, faEdit } from '@fortawesome/free-regular-svg-icons';\r\nimport { faTrash } from '@fortawesome/free-solid-svg-icons';\r\n\r\nimport \"../../css/Global.css\";\r\nimport \"../../css/Forum.css\";\r\nimport { db } from '../../firebase';\r\nimport { useAuth } from '../../modules/auth';\r\n\r\nconst ForumQuestions: React.FC<{ comments: any[] }> = (props) => {\r\n    const { userID } = useAuth();\r\n\r\n    const [loading, setLoading] = useState(false);\r\n    const [showEditCommentModal, setShowEditCommentModal] = useState(false);\r\n    const [deleteAlert, setDeleteAlert] = useState({ alert: false, loading: false });\r\n    const [comments, setComments] = useState([]);\r\n    const [entry, setEntry] = useState(\"\");\r\n    const [toBeEdited, setToBeEdited] = useState(0);\r\n    const [toBeDeleted, setToBeDeleted] = useState(0);\r\n\r\n    const handleDelete = async (postId: string) => {\r\n        try {\r\n            setDeleteAlert({ alert: false, loading: true });\r\n            await db.collection('Forum').doc(userID).collection('Comments').doc(postId).update({\r\n                deleted: true\r\n            });\r\n        } catch (e) {\r\n            return console.log(e);\r\n        } finally {\r\n            setDeleteAlert({ alert: false, loading: false });\r\n        }\r\n    }\r\n\r\n    const handleEdit = async (postId: string) => {\r\n        try {\r\n            setLoading(true);\r\n            await db.collection('Forum').doc(userID).collection('Comments').doc(postId).update({\r\n                entry: entry\r\n            });\r\n        } catch (e) {\r\n            return console.log(e);\r\n        } finally {\r\n            setShowEditCommentModal(false);\r\n            setLoading(false);\r\n            setEntry(\"\");\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        return db.collection('Forum').doc(userID).collection('Comments').where(\"deleted\", \"==\", false).onSnapshot(snaps => {\r\n            const posts: any = [];\r\n            \r\n            snaps.forEach(async (snap) => {\r\n                let post: any = { ...snap.data() }\r\n\r\n                await db.collection('Forum').get().then(users => {\r\n                    users.forEach(user => {\r\n                        return db.collection('Forum').doc(user.id).collection('Questions').doc(snap.data().questionId.toString()).onSnapshot(question => {\r\n                            if(question.exists) {\r\n                                post.question = question.data()?.entry;\r\n                                post.questionRemoved = question.data()?.deleted;\r\n                            }\r\n                        });\r\n                    });\r\n                });\r\n                posts.push(post)\r\n            });\r\n\r\n            setTimeout(() => {\r\n                setComments(posts);\r\n                setLoading(false);\r\n            }, 500);\r\n        });\r\n    }, []);\r\n\r\n    return (\r\n        <>\r\n            <IonGrid id=\"forumQnsCom-tableGrid\">\r\n                <IonRow id=\"forumQnsCom-tableHeader\" className=\"ion-justify-content-center\">\r\n                    <IonCol className=\"forumQnsCom-Header ion-text-wrap\">Question</IonCol>\r\n                    <IonCol className=\"forumQnsCom-Header ion-text-wrap\">My Comment</IonCol>\r\n                    <IonCol className=\"forumQnsCom-Header ion-text-wrap\">Posted Date/Time</IonCol>\r\n                    <IonCol className=\"forumQnsCom-Header ion-text-wrap\"><IonRow className=\"ion-justify-content-center\">No. of</IonRow><IonRow className=\"ion-justify-content-center\"><FontAwesomeIcon icon={faCommentDots} size=\"lg\" /></IonRow></IonCol>\r\n                    <IonCol className=\"forumQnsCom-Header ion-text-wrap\">Edit Comment</IonCol>\r\n                    <IonCol className=\"forumQnsCom-Header ion-text-wrap\">Delete Comment</IonCol>\r\n                </IonRow>\r\n                {comments.map((post: any) => (\r\n                    <IonRow className=\"ion-justify-content-center\" key={post.id}>\r\n                        <IonCol className=\"forumQnsCom-Data ion-text-wrap\">{post.questionRemoved === false ? post.question : \"[deleted]\"}</IonCol>\r\n                        <IonCol className=\"forumQnsCom-Data ion-text-wrap\">{post.entry}</IonCol>\r\n                        <IonCol className=\"forumQnsCom-Data ion-text-wrap\">{post.dateTime}</IonCol>\r\n                        <IonCol className=\"forumQnsCom-Data ion-text-wrap\">{post.hasOwnProperty('commentId') === false ? post.noOfReplies : \"-\"}</IonCol>\r\n                        <IonCol className=\"forumQnsCom-Data ion-text-wrap\">\r\n                            {/* <Forum_EditCommentModal /> */}\r\n                            <IonButton onClick={() => [setShowEditCommentModal(true), setToBeEdited(post.id)]} className=\"forumQnsCom-DataBtn\" size=\"small\" style={{ marginTop: \"-5%\", marginBottom: \"-5%\" }}><FontAwesomeIcon icon={faEdit} size=\"lg\" /></IonButton>\r\n                        </IonCol>\r\n                        <IonCol className=\"forumQnsCom-Data ion-text-wrap\">\r\n                            {/* <Forum_DeleteComment /> */}\r\n                            <IonButton onClick={() => [setDeleteAlert({ alert: true, loading: false }), setToBeDeleted(post.id)]} className=\"forumQnsCom-DataBtn\" size=\"small\" style={{ marginTop: \"-5%\", marginBottom: \"-5%\" }}><FontAwesomeIcon icon={faTrash} size=\"lg\" /></IonButton>\r\n                        </IonCol>\r\n                    </IonRow>\r\n                ))}\r\n            </IonGrid>\r\n            <IonModal isOpen={showEditCommentModal} cssClass='post-question-modal' onDidDismiss={() => setShowEditCommentModal(false)}>\r\n                <IonContent>\r\n                    <IonGrid id=\"postQns-modal-container\">\r\n                        <IonRow style={{ paddingTop: '1%' }}>\r\n                            <IonLabel id=\"postQns-title\">Edit Comment</IonLabel>\r\n                        </IonRow>\r\n                        <IonItemDivider />\r\n                        <IonRow id=\"postQns-modal-inputArea\">\r\n                            <IonTextarea rows={11} contentEditable={true} value={entry} onIonChange={e => setEntry(e.detail.value!)} required></IonTextarea>\r\n                        </IonRow>\r\n                        <IonRow className=\"ion-justify-content-around\">\r\n                            <IonButton id=\"postQns-close-button\" fill=\"outline\" onClick={() => setShowEditCommentModal(false)}>CANCEL</IonButton>\r\n                            <IonButton id=\"postQns-post-button\" onClick={() => handleEdit(toBeEdited.toString())}>UPDATE</IonButton>\r\n                        </IonRow>\r\n                    </IonGrid>\r\n                </IonContent>\r\n            </IonModal>\r\n\r\n            {/* Delete Comment Alert */}\r\n            <IonAlert\r\n                isOpen={deleteAlert.alert}\r\n                cssClass='alertBox' header={'Delete Comment'}\r\n                message={'Are you sure you want to delete the comment?'}\r\n                buttons={[\r\n                    {\r\n                        text: 'NO',\r\n                        handler: () => setDeleteAlert({ alert: false, loading: false })\r\n                    }, {\r\n                        text: 'YES',\r\n                        handler: () => handleDelete(toBeDeleted.toString())\r\n                    }]}\r\n            ></IonAlert>\r\n            <IonLoading isOpen={deleteAlert.loading || loading} />\r\n        </>\r\n    );\r\n};\r\n\r\nexport default ForumQuestions;"]},"metadata":{},"sourceType":"module"}