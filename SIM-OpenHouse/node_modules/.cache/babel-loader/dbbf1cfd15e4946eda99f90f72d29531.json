{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import{IonAlert,IonButton,IonCheckbox,IonCol,IonContent,IonFooter,IonGrid,IonHeader,IonIcon,IonItem,IonItemDivider,IonLabel,IonList,IonLoading,IonModal,IonPage,IonRouterLink,IonRow,IonSearchbar,IonSegment,IonSegmentButton,IonText,IonTextarea,IonTitle,IonToolbar}from\"@ionic/react\";import React,{useEffect,useState}from'react';import{useHistory}from\"react-router-dom\";import{useForm}from\"react-hook-form\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faClock,faCommentAlt}from\"@fortawesome/free-regular-svg-icons\";import{addCircleSharp,personSharp}from\"ionicons/icons\";import\"../../css/Global.css\";import\"../../css/Forum.css\";import TopNav from'../../components/TopNav';import ForumRules from'../../components/Forum/ForumRules';import Forum_FlagModal from\"../../components/Forum/Forum_FlagModal\";import{db}from\"../../firebase\";import{useAuth}from\"../../modules/auth\";import{forumPostsDesc}from\"../../modules/compare\";var Forum=function Forum(){var _useAuth=useAuth(),userID=_useAuth.userID;var _useForm=useForm(),register=_useForm.register,errors=_useForm.errors,handleSubmit=_useForm.handleSubmit;var history=useHistory();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),forumDisabled=_useState4[0],setForumDisabled=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),checked=_useState6[0],setChecked=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),agreedTOC=_useState8[0],setAgreedTOC=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),showPostModal=_useState10[0],setShowPostModal=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),modalSegmentValue=_useState12[0],setModalSegmentValue=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),entry=_useState14[0],setEntry=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),questions=_useState16[0],setQuestions=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),keyword=_useState18[0],setKeyword=_useState18[1];var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);if(!checked){_context.next=4;break;}_context.next=4;return db.collection('Forum').doc(userID).update({readRules:true});case 4:setLoading(false);case 5:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(){return _ref.apply(this,arguments);};}();var handleQuestion=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var time,name,docRef;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setLoading(true);time=new Date();if(!(entry!==\"\")){_context2.next=9;break;}_context2.next=6;return db.collection('Students').doc(userID).get().then(function(doc){name=doc.data().firstName+\" \"+doc.data().lastName;});case 6:docRef=db.collection('Forum').doc(userID).collection('Questions').doc(time.getTime().toString());_context2.next=9;return docRef.set({id:+docRef.id,entry:entry,posterName:name,posterId:userID,dateTime:time.toLocaleString().replace(/\\//g,\"-\"),noOfComments:0,deleted:false,reported:false});case 9:_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);return _context2.abrupt(\"return\",console.log(_context2.t0));case 14:_context2.prev=14;setLoading(false);setShowPostModal(false);setEntry(\"\");return _context2.finish(14);case 19:case\"end\":return _context2.stop();}}},_callee2,null,[[0,11,14,19]]);}));return function handleQuestion(){return _ref2.apply(this,arguments);};}();useEffect(function(){setQuestions([]);db.collection('Openhouse').get().then(function(snapshot){var disabled=false;snapshot.forEach(function(doc){if(doc.data().disableForum){disabled=true;setLoading(false);}});setForumDisabled(disabled);if(!disabled){/* db.collection('Forum').get().then(uRef => {\r\n                    const questions: any = [];\r\n    \r\n                    uRef.forEach(user => {\r\n                        if (user.id === userID && user.data().suspended) \r\n                            return history.goBack();\r\n    \r\n                        return db.collection('Forum').doc(user.id).collection('Questions').onSnapshot(entries => {\r\n                            entries.docChanges().forEach(change => {\r\n                                questions.unshift({\r\n                                    id: +change.doc.id,\r\n                                    entry: change.doc.data().entry,\r\n                                    dateTime: change.doc.data().dateTime,\r\n                                    user: change.doc.data().posterName,\r\n                                    uid: change.doc.data().posterId,\r\n                                    commentCount: change.doc.data().noOfComments,\r\n                                    removed: change.doc.data().deleted\r\n                                });\r\n                            });\r\n                        });\r\n                    });\r\n    \r\n                    setTimeout(() => {\r\n                        questions.sort(forumPostsDesc);\r\n                        setQuestions(questions);\r\n                        setLoading(false);\r\n                    }, 500);\r\n                }); */var readRules=false;return db.collection('Forum').doc(userID).onSnapshot(function(snapshot){if(snapshot.exists){var _snapshot$data,_snapshot$data2;if((_snapshot$data=snapshot.data())===null||_snapshot$data===void 0?void 0:_snapshot$data.suspended)return history.goBack();if((_snapshot$data2=snapshot.data())===null||_snapshot$data2===void 0?void 0:_snapshot$data2.readRules)readRules=true;}setAgreedTOC(readRules);if(readRules){setLoading(true);return db.collectionGroup('Questions').onSnapshot(function(entries){var questions=[];entries.forEach(function(question){questions.unshift({id:+question.id,entry:question.data().entry,dateTime:question.data().dateTime,user:question.data().posterName,uid:question.data().posterId,commentCount:question.data().noOfComments,removed:question.data().deleted});});setTimeout(function(){questions.sort(forumPostsDesc);setQuestions(questions);setLoading(false);},500);});}});}}).catch(function(error){return console.log(error);});},[]);return/*#__PURE__*/React.createElement(IonPage,null,/*#__PURE__*/React.createElement(IonHeader,null,/*#__PURE__*/React.createElement(TopNav,{title:\"Forum\",route:\"/u/home\",backarrow:true,hamburger:true})),/*#__PURE__*/React.createElement(IonContent,{fullscreen:true,id:\"forum-content\"},/*#__PURE__*/React.createElement(IonAlert,{isOpen:forumDisabled,onDidDismiss:function onDidDismiss(){history.goBack();},cssClass:\"alertBox\",mode:\"md\",header:'Forum Unvailable',message:'The forum is currently not available at this time. The forum will reopen again in the next Open House.',buttons:['Ok']}),agreedTOC===true?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(IonGrid,{id:\"forum-searchbar-container\"},/*#__PURE__*/React.createElement(IonRow,null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:function onSubmit(e){e.preventDefault();history.push(\"/u/forumSearch/\".concat(keyword));}},/*#__PURE__*/React.createElement(IonSearchbar,{value:keyword,onIonChange:function onIonChange(e){return setKeyword(e.detail.value);},enterkeyhint:\"search\",id:\"forum-searchbar\",animated:true})))),/*#__PURE__*/React.createElement(IonGrid,{id:\"forum-heading-container\"},/*#__PURE__*/React.createElement(IonRow,{className:\"ion-justify-content-start\"},/*#__PURE__*/React.createElement(IonCol,{size:\"10\",className:\"ion-align-self-center forum-col\"},/*#__PURE__*/React.createElement(IonTitle,{id:\"forum-heading\"},\"All Discussions\")),/*#__PURE__*/React.createElement(IonCol,{size:\"2\",className:\"forum-col\"},/*#__PURE__*/React.createElement(ForumRules,null)))),questions.length>0?questions.map(function(post){return post.removed===false?/*#__PURE__*/React.createElement(IonList,{className:\"forum-container\",key:post.id},/*#__PURE__*/React.createElement(IonGrid,null,/*#__PURE__*/React.createElement(IonRouterLink,{href:\"/u/forumViewQuestion/\".concat(post.id,\"/\").concat(post.uid)},/*#__PURE__*/React.createElement(IonRow,null,/*#__PURE__*/React.createElement(IonLabel,null,/*#__PURE__*/React.createElement(IonText,{className:\"forum-question\"},post.entry))),/*#__PURE__*/React.createElement(IonRow,{className:\"ion-justify-content-end\"},/*#__PURE__*/React.createElement(IonText,{className:\"forum-question-details\",id:\"forum-userName\"},\"~ \",post.user))),/*#__PURE__*/React.createElement(IonRow,{className:\"ion-align-items-end ion-justify-content-start\",id:\"forum-question-detail-container\"},/*#__PURE__*/React.createElement(IonCol,{size:\"1\",className:\"forum-col ion-align-self-end\"},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faClock,size:\"sm\"})),/*#__PURE__*/React.createElement(IonCol,{size:\"6\",className:\"forum-col ion-align-self-end\"},/*#__PURE__*/React.createElement(IonText,{className:\"forum-question-details\"},post.dateTime)),/*#__PURE__*/React.createElement(IonCol,{size:\"1\",className:\"forum-col ion-align-self-end\"},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faCommentAlt,size:\"sm\"})),/*#__PURE__*/React.createElement(IonCol,{size:\"3\",className:\"forum-col ion-align-self-end\"},/*#__PURE__*/React.createElement(IonText,{className:\"forum-question-details\"},post.commentCount)),/*#__PURE__*/React.createElement(IonCol,{size:\"1\",className:\"ion-align-self-end forum-col\"},/*#__PURE__*/React.createElement(Forum_FlagModal,{disabled:false,postId:post.id,postType:\"Question\",postContent:post.entry,offender:post.user,offenderId:post.uid}))))):null;}):/*#__PURE__*/React.createElement(IonGrid,null,/*#__PURE__*/React.createElement(IonRow,{className:\"ion-justify-content-center\"},/*#__PURE__*/React.createElement(IonText,{color:\"medium\"},\"Looks like there are no discussion going on right now. Why not start one?\")))):/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit(onSubmit)},/*#__PURE__*/React.createElement(IonGrid,{id:\"forumRulesGrid\"},/*#__PURE__*/React.createElement(IonRow,{id:\"important-notice\"},/*#__PURE__*/React.createElement(IonText,null,\"*Important Notice*\")),/*#__PURE__*/React.createElement(IonRow,{id:\"forum-rules\"},/*#__PURE__*/React.createElement(IonText,null,\"Forum Rules\")),/*#__PURE__*/React.createElement(IonRow,{id:\"forum-instructions\"},/*#__PURE__*/React.createElement(IonText,null,\"This forum is strictly for discussion about programmes offered by SIM and its partner universities and SIM Open House. Please adhere to the following rules before posting in the forum.\")),/*#__PURE__*/React.createElement(IonRow,{id:\"forum-instructions\"},/*#__PURE__*/React.createElement(IonText,null,\"1. Remain respectful of other users at all times.\")),/*#__PURE__*/React.createElement(IonRow,{id:\"forum-instructions\"},/*#__PURE__*/React.createElement(IonText,null,\"2. Please do not spam. The definition of spam is an irrelevant or advertising post. Any post that is considered spam will be removed.\")),/*#__PURE__*/React.createElement(IonRow,{id:\"forum-instructions\"},/*#__PURE__*/React.createElement(IonText,null,\"3. Do not post offensive posts, links or images.\")),/*#__PURE__*/React.createElement(IonRow,{id:\"forum-instructions\"},/*#__PURE__*/React.createElement(IonText,null,\"4. Please do not post threads text in all CAPITALS since this is considered to be shouting.\")),/*#__PURE__*/React.createElement(IonRow,{id:\"forum-instructions\"},/*#__PURE__*/React.createElement(IonText,null,\"Anyone who breaks any of the above rules will be banned from the forum. Let's keep this forum safe for everyone.\")),/*#__PURE__*/React.createElement(IonRow,{className:\"ion-justify-content-center\"},/*#__PURE__*/React.createElement(IonItem,{id:\"forum-checkbox-container\"},/*#__PURE__*/React.createElement(IonCol,{size:\"2\",sizeSm:\"2\",className:\"ion-align-self-center\"},/*#__PURE__*/React.createElement(IonCheckbox,{name:\"forumCheckbox\",checked:checked,onIonChange:function onIonChange(e){return setChecked(e.detail.checked);},ref:register({validate:function validate(value){return checked===true;}})})),/*#__PURE__*/React.createElement(IonCol,{size:\"10\",sizeSm:\"10\"},/*#__PURE__*/React.createElement(IonText,{id:\"forum-checkbox-text\"},\"*I have read the above forum rules and agree to abide to the rules stated above. I understand that should I break any of the rules above, I may be banned from the forum.\"))),errors.forumCheckbox&&errors.forumCheckbox.type===\"validate\"&&/*#__PURE__*/React.createElement(\"div\",{className:\"errorMessage\"},\"*Please check the above after reading the rules to proceed to the forum\")),/*#__PURE__*/React.createElement(IonRow,{class:\"ion-justify-content-center\"},/*#__PURE__*/React.createElement(IonButton,{id:\"forumRulesBtn\",type:\"submit\"},\"PROCEED TO FORUM\")))),/*#__PURE__*/React.createElement(IonModal,{isOpen:showPostModal,cssClass:\"post-question-modal\",onDidDismiss:function onDidDismiss(){return setShowPostModal(false);}},/*#__PURE__*/React.createElement(IonContent,null,/*#__PURE__*/React.createElement(IonGrid,{id:\"postQns-modal-container\"},/*#__PURE__*/React.createElement(IonRow,{style:{paddingTop:'1%'}},/*#__PURE__*/React.createElement(IonLabel,{id:\"postQns-title\"},\"Post Question\")),/*#__PURE__*/React.createElement(IonItemDivider,null),/*#__PURE__*/React.createElement(IonRow,{id:\"postQns-modal-inputArea\"},/*#__PURE__*/React.createElement(IonTextarea,{value:entry,onIonChange:function onIonChange(e){return setEntry(e.detail.value);},rows:11,placeholder:\"Type your question here...\",required:true})),/*#__PURE__*/React.createElement(IonRow,{className:\"ion-justify-content-around\"},/*#__PURE__*/React.createElement(IonButton,{id:\"postQns-close-button\",fill:\"outline\",onClick:function onClick(){return[setShowPostModal(false),setModalSegmentValue('')];}},\"CLOSE\"),/*#__PURE__*/React.createElement(IonButton,{id:\"postQns-post-button\",onClick:handleQuestion},\"POST\"))))),/*#__PURE__*/React.createElement(IonLoading,{isOpen:loading})),agreedTOC===true?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(IonFooter,null,/*#__PURE__*/React.createElement(IonToolbar,null,/*#__PURE__*/React.createElement(IonSegment,{scrollable:true,value:modalSegmentValue,onIonChange:function onIonChange(e){return console.log(\"\".concat(e.detail.value));}},/*#__PURE__*/React.createElement(IonSegmentButton,{className:\"forum-segmentBtn\",value:\"postQuestionBtn\",onClick:function onClick(){return[setShowPostModal(true),setModalSegmentValue('postQuestionBtn')];}},/*#__PURE__*/React.createElement(IonIcon,{icon:addCircleSharp})),/*#__PURE__*/React.createElement(IonSegmentButton,{className:\"forum-segmentBtn\",value:\"forumUserBtn\",onClick:function onClick(e){e.preventDefault();history.push('/u/forumUser');}},/*#__PURE__*/React.createElement(IonIcon,{icon:personSharp})))))):'');};export default Forum;","map":{"version":3,"sources":["D:/BearBear/Coding_Projects/UOW-CSIT321 (FYP)/FYP20S313-Mobile/SIM-OpenHouse/src/pages/Forum/Forum.tsx"],"names":["IonAlert","IonButton","IonCheckbox","IonCol","IonContent","IonFooter","IonGrid","IonHeader","IonIcon","IonItem","IonItemDivider","IonLabel","IonList","IonLoading","IonModal","IonPage","IonRouterLink","IonRow","IonSearchbar","IonSegment","IonSegmentButton","IonText","IonTextarea","IonTitle","IonToolbar","React","useEffect","useState","useHistory","useForm","FontAwesomeIcon","faClock","faCommentAlt","addCircleSharp","personSharp","TopNav","ForumRules","Forum_FlagModal","db","useAuth","forumPostsDesc","Forum","userID","register","errors","handleSubmit","history","loading","setLoading","forumDisabled","setForumDisabled","checked","setChecked","agreedTOC","setAgreedTOC","showPostModal","setShowPostModal","modalSegmentValue","setModalSegmentValue","entry","setEntry","questions","setQuestions","keyword","setKeyword","onSubmit","collection","doc","update","readRules","handleQuestion","time","Date","get","then","name","data","firstName","lastName","docRef","getTime","toString","set","id","posterName","posterId","dateTime","toLocaleString","replace","noOfComments","deleted","reported","console","log","snapshot","disabled","forEach","disableForum","onSnapshot","exists","suspended","goBack","collectionGroup","entries","question","unshift","user","uid","commentCount","removed","setTimeout","sort","catch","error","e","preventDefault","push","detail","value","length","map","post","validate","forumCheckbox","type","paddingTop"],"mappings":"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","sourcesContent":["import { IonAlert, IonButton, IonCheckbox, IonCol, IonContent, IonFooter, IonGrid, IonHeader, IonIcon, IonItem, IonItemDivider, IonLabel, IonList, IonLoading, IonModal, IonPage, IonRouterLink, IonRow, IonSearchbar, IonSegment, IonSegmentButton, IonText, IonTextarea, IonTitle, IonToolbar } from \"@ionic/react\";\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faClock, faCommentAlt } from \"@fortawesome/free-regular-svg-icons\";\r\nimport { addCircleSharp, personSharp } from \"ionicons/icons\";\r\n\r\nimport \"../../css/Global.css\";\r\nimport \"../../css/Forum.css\";\r\nimport TopNav from '../../components/TopNav';\r\nimport ForumRules from '../../components/Forum/ForumRules';\r\nimport Forum_FlagModal from \"../../components/Forum/Forum_FlagModal\";\r\nimport { db } from \"../../firebase\";\r\nimport { useAuth } from \"../../modules/auth\";\r\nimport { forumPostsDesc } from \"../../modules/compare\";\r\n\r\nconst Forum: React.FC = () => {\r\n    const { userID } = useAuth();\r\n    const { register, errors, handleSubmit } = useForm();\r\n\r\n    let history = useHistory();\r\n\r\n    const [loading, setLoading] = useState(false);\r\n    const [forumDisabled, setForumDisabled] = useState(false);\r\n    const [checked, setChecked] = useState(false);\r\n    const [agreedTOC, setAgreedTOC] = useState(true);\r\n    const [showPostModal, setShowPostModal] = useState(false);\r\n    const [modalSegmentValue, setModalSegmentValue] = useState('');\r\n    const [entry, setEntry] = useState(\"\");\r\n    const [questions, setQuestions] = useState([]);\r\n    const [keyword, setKeyword] = useState(\"\");\r\n\r\n    const onSubmit = async () => {\r\n        setLoading(true);\r\n        if (checked)\r\n            await db.collection('Forum').doc(userID).update({ readRules: true });\r\n        setLoading(false);\r\n    };\r\n\r\n    const handleQuestion = async () => {\r\n        try {\r\n            setLoading(true);\r\n            const time = new Date();\r\n            let name: string;\r\n\r\n            if (entry !== \"\") {\r\n                await db.collection('Students').doc(userID).get().then((doc: any) => {\r\n                    name = doc.data().firstName + \" \" + doc.data().lastName;\r\n                });\r\n\r\n                const docRef = db.collection('Forum').doc(userID).collection('Questions').doc((time.getTime()).toString());\r\n                await docRef.set({\r\n                    id: +docRef.id,\r\n                    entry: entry,\r\n                    posterName: name!,\r\n                    posterId: userID,\r\n                    dateTime: time.toLocaleString().replace(/\\//g, \"-\"),\r\n                    noOfComments: 0,\r\n                    deleted: false,\r\n                    reported: false\r\n                });\r\n            }\r\n        } catch (e) {\r\n            return console.log(e);\r\n        } finally {\r\n            setLoading(false);\r\n            setShowPostModal(false);\r\n            setEntry(\"\");\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        setQuestions([]);\r\n\r\n        db.collection('Openhouse').get().then(snapshot => {\r\n            let disabled = false;\r\n            snapshot.forEach(doc => {\r\n                if (doc.data().disableForum) {\r\n                    disabled = true;\r\n                    setLoading(false);\r\n                }\r\n            });\r\n            setForumDisabled(disabled);\r\n\r\n            if (!disabled) {\r\n                /* db.collection('Forum').get().then(uRef => {\r\n                    const questions: any = [];\r\n    \r\n                    uRef.forEach(user => {\r\n                        if (user.id === userID && user.data().suspended) \r\n                            return history.goBack();\r\n    \r\n                        return db.collection('Forum').doc(user.id).collection('Questions').onSnapshot(entries => {\r\n                            entries.docChanges().forEach(change => {\r\n                                questions.unshift({\r\n                                    id: +change.doc.id,\r\n                                    entry: change.doc.data().entry,\r\n                                    dateTime: change.doc.data().dateTime,\r\n                                    user: change.doc.data().posterName,\r\n                                    uid: change.doc.data().posterId,\r\n                                    commentCount: change.doc.data().noOfComments,\r\n                                    removed: change.doc.data().deleted\r\n                                });\r\n                            });\r\n                        });\r\n                    });\r\n    \r\n                    setTimeout(() => {\r\n                        questions.sort(forumPostsDesc);\r\n                        setQuestions(questions);\r\n                        setLoading(false);\r\n                    }, 500);\r\n                }); */\r\n\r\n                let readRules = false;\r\n                return db.collection('Forum').doc(userID).onSnapshot(snapshot => {\r\n                    if (snapshot.exists) {\r\n                        if (snapshot.data()?.suspended)\r\n                            return history.goBack();\r\n\r\n                        if (snapshot.data()?.readRules) \r\n                            readRules = true;\r\n                    }\r\n                    setAgreedTOC(readRules);\r\n\r\n                    if (readRules) {\r\n                        setLoading(true);\r\n                        return db.collectionGroup('Questions').onSnapshot(entries => {\r\n                            const questions: any = [];\r\n                            entries.forEach(question => {\r\n                                questions.unshift({\r\n                                    id: +question.id,\r\n                                    entry: question.data().entry,\r\n                                    dateTime: question.data().dateTime,\r\n                                    user: question.data().posterName,\r\n                                    uid: question.data().posterId,\r\n                                    commentCount: question.data().noOfComments,\r\n                                    removed: question.data().deleted\r\n                                });\r\n                            });\r\n\r\n                            setTimeout(() => {\r\n                                questions.sort(forumPostsDesc);\r\n                                setQuestions(questions);\r\n                                setLoading(false);\r\n                            }, 500);\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n        }).catch((error) => console.log(error));\r\n    }, []);\r\n\r\n    return (\r\n        <IonPage>\r\n            <IonHeader>\r\n                <TopNav title=\"Forum\" route=\"/u/home\" backarrow={true} hamburger={true} />\r\n            </IonHeader>\r\n\r\n            <IonContent fullscreen id=\"forum-content\">\r\n                <IonAlert\r\n                    isOpen={forumDisabled}\r\n                    onDidDismiss={() => { history.goBack() }}\r\n                    cssClass='alertBox'\r\n                    mode='md'\r\n                    header={'Forum Unvailable'}\r\n                    message={'The forum is currently not available at this time. The forum will reopen again in the next Open House.'}\r\n                    buttons={['Ok']}\r\n                ></IonAlert>\r\n\r\n                {agreedTOC === true ?\r\n                    <>\r\n                        <IonGrid id=\"forum-searchbar-container\">\r\n                            <IonRow>\r\n                                <form onSubmit={e => { e.preventDefault(); history.push(`/u/forumSearch/${keyword}`); }}>\r\n                                    <IonSearchbar value={keyword} onIonChange={e => setKeyword(e.detail.value!)} enterkeyhint=\"search\" id=\"forum-searchbar\" animated></IonSearchbar>\r\n                                </form>\r\n                            </IonRow>\r\n                        </IonGrid>\r\n\r\n\r\n                        <IonGrid id=\"forum-heading-container\">\r\n                            <IonRow className=\"ion-justify-content-start\">\r\n                                <IonCol size=\"10\" className=\"ion-align-self-center forum-col\">\r\n                                    <IonTitle id=\"forum-heading\">All Discussions</IonTitle>\r\n                                </IonCol>\r\n                                <IonCol size=\"2\" className=\"forum-col\">\r\n                                    <ForumRules />\r\n                                </IonCol>\r\n                            </IonRow>\r\n                        </IonGrid>\r\n\r\n                        {/* Display all Questions */}\r\n                        {questions.length > 0 ?\r\n                            questions.map((post: any) => (\r\n                                post.removed === false ? (\r\n                                    <IonList className=\"forum-container\" key={post.id}>\r\n                                        <IonGrid>\r\n                                            <IonRouterLink href={`/u/forumViewQuestion/${post.id}/${post.uid}`}>\r\n                                                <IonRow>\r\n                                                    <IonLabel>\r\n                                                        <IonText className=\"forum-question\">{post.entry}</IonText>\r\n                                                    </IonLabel>\r\n                                                </IonRow>\r\n                                                <IonRow className=\"ion-justify-content-end\">\r\n                                                    <IonText className=\"forum-question-details\" id=\"forum-userName\">~ {post.user}</IonText>\r\n                                                </IonRow>\r\n                                            </IonRouterLink>\r\n                                            <IonRow className=\"ion-align-items-end ion-justify-content-start\" id=\"forum-question-detail-container\">\r\n                                                <IonCol size=\"1\" className=\"forum-col ion-align-self-end\">\r\n                                                    <FontAwesomeIcon icon={faClock} size=\"sm\" />\r\n                                                </IonCol>\r\n                                                <IonCol size=\"6\" className=\"forum-col ion-align-self-end\">\r\n                                                    <IonText className=\"forum-question-details\">{post.dateTime}</IonText>\r\n                                                </IonCol>\r\n                                                <IonCol size=\"1\" className=\"forum-col ion-align-self-end\">\r\n                                                    <FontAwesomeIcon icon={faCommentAlt} size=\"sm\" />\r\n                                                </IonCol>\r\n                                                <IonCol size=\"3\" className=\"forum-col ion-align-self-end\">\r\n                                                    <IonText className=\"forum-question-details\">{post.commentCount}</IonText>\r\n                                                </IonCol>\r\n                                                <IonCol size=\"1\" className=\"ion-align-self-end forum-col\">\r\n                                                    <Forum_FlagModal disabled={false} postId={post.id} postType={\"Question\"} postContent={post.entry} offender={post.user} offenderId={post.uid} />\r\n                                                </IonCol>\r\n                                            </IonRow>\r\n                                        </IonGrid>\r\n                                    </IonList>\r\n                                ) : null\r\n                            )) : (\r\n                                <IonGrid>\r\n                                    <IonRow className=\"ion-justify-content-center\">\r\n                                        <IonText color=\"medium\">Looks like there are no discussion going on right now. Why not start one?</IonText>\r\n                                    </IonRow>\r\n                                </IonGrid>\r\n                            )\r\n                        }\r\n                    </>\r\n\r\n                    : <form onSubmit={handleSubmit(onSubmit)}>\r\n                        <IonGrid id=\"forumRulesGrid\">\r\n                            <IonRow id=\"important-notice\">\r\n                                <IonText>*Important Notice*</IonText>\r\n                            </IonRow>\r\n                            <IonRow id=\"forum-rules\">\r\n                                <IonText>Forum Rules</IonText>\r\n                            </IonRow>\r\n                            <IonRow id=\"forum-instructions\">\r\n                                <IonText>This forum is strictly for discussion about programmes offered by SIM and its partner universities and SIM\r\n                                Open House. Please adhere to the following rules before posting in the forum.\r\n                                </IonText>\r\n                            </IonRow>\r\n                            <IonRow id=\"forum-instructions\">\r\n                                <IonText>1. Remain respectful of other users at all times.</IonText>\r\n                            </IonRow>\r\n                            <IonRow id=\"forum-instructions\">\r\n                                <IonText>2. Please do not spam. The definition of spam is an irrelevant or advertising post. Any post that is considered spam will be removed.</IonText>\r\n                            </IonRow>\r\n                            <IonRow id=\"forum-instructions\">\r\n                                <IonText>3. Do not post offensive posts, links or images.</IonText>\r\n                            </IonRow>\r\n                            <IonRow id=\"forum-instructions\">\r\n                                <IonText>4. Please do not post threads text in all CAPITALS since this is considered to be shouting.</IonText>\r\n                            </IonRow>\r\n                            <IonRow id=\"forum-instructions\">\r\n                                <IonText>Anyone who breaks any of the above rules will be banned from the forum. Let's keep this forum safe for everyone.</IonText>\r\n                            </IonRow>\r\n                            <IonRow className=\"ion-justify-content-center\">\r\n                                <IonItem id=\"forum-checkbox-container\">\r\n                                    <IonCol size=\"2\" sizeSm=\"2\" className=\"ion-align-self-center\">\r\n                                        <IonCheckbox name=\"forumCheckbox\" checked={checked} onIonChange={(e) => setChecked(e.detail.checked)} ref={register({ validate: (value) => checked === true })}></IonCheckbox>\r\n                                    </IonCol>\r\n                                    <IonCol size=\"10\" sizeSm=\"10\">\r\n                                        <IonText id=\"forum-checkbox-text\">\r\n                                            *I have read the above forum rules and agree to abide to the rules stated above. I understand that should I break any of the rules above, I may be banned from the forum.\r\n                                        </IonText>\r\n                                    </IonCol>\r\n                                </IonItem>\r\n                                {errors.forumCheckbox && errors.forumCheckbox.type === \"validate\" && <div className=\"errorMessage\">*Please check the above after reading the rules to proceed to the forum</div>}\r\n                            </IonRow>\r\n                            <IonRow class=\"ion-justify-content-center\">\r\n                                <IonButton id=\"forumRulesBtn\" type=\"submit\">PROCEED TO FORUM</IonButton>\r\n                            </IonRow>\r\n                        </IonGrid>\r\n                    </form>\r\n                }\r\n\r\n                {/* Post Question Modal */}\r\n                <IonModal isOpen={showPostModal} cssClass='post-question-modal' onDidDismiss={() => setShowPostModal(false)}>\r\n                    <IonContent>\r\n                        <IonGrid id=\"postQns-modal-container\">\r\n                            <IonRow style={{ paddingTop: '1%' }}>\r\n                                <IonLabel id=\"postQns-title\">Post Question</IonLabel>\r\n                            </IonRow>\r\n                            <IonItemDivider />\r\n                            <IonRow id=\"postQns-modal-inputArea\">\r\n                                <IonTextarea value={entry} onIonChange={e => setEntry(e.detail.value!)} rows={11} placeholder=\"Type your question here...\" required></IonTextarea>\r\n                            </IonRow>\r\n                            <IonRow className=\"ion-justify-content-around\">\r\n                                <IonButton id=\"postQns-close-button\" fill=\"outline\" onClick={() => [setShowPostModal(false), setModalSegmentValue('')]}>CLOSE</IonButton>\r\n                                <IonButton id=\"postQns-post-button\" onClick={handleQuestion}>POST</IonButton>\r\n                            </IonRow>\r\n                        </IonGrid>\r\n                    </IonContent>\r\n                </IonModal>\r\n                <IonLoading isOpen={loading} />\r\n            </IonContent>\r\n\r\n            {/* Bottom Tabs */}\r\n            {agreedTOC === true ?\r\n                <>\r\n                    <IonFooter>\r\n                        <IonToolbar>\r\n                            <IonSegment scrollable value={modalSegmentValue} onIonChange={(e) => console.log(`${e.detail.value}`)}>\r\n                                <IonSegmentButton className=\"forum-segmentBtn\" value=\"postQuestionBtn\" onClick={() => [setShowPostModal(true), setModalSegmentValue('postQuestionBtn')]}><IonIcon icon={addCircleSharp} /></IonSegmentButton>\r\n                                <IonSegmentButton className=\"forum-segmentBtn\" value=\"forumUserBtn\" onClick={(e) => { e.preventDefault(); history.push('/u/forumUser'); }}><IonIcon icon={personSharp} /></IonSegmentButton>\r\n                            </IonSegment>\r\n                        </IonToolbar>\r\n                    </IonFooter>\r\n                </> : ''\r\n            }\r\n        </IonPage>\r\n    );\r\n};\r\n\r\nexport default Forum;"]},"metadata":{},"sourceType":"module"}