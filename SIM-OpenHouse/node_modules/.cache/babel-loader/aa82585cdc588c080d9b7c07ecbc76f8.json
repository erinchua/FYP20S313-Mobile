{"ast":null,"code":"var _jsxFileName = \"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\src\\\\components\\\\Forum\\\\ForumComments.tsx\";\nimport { IonAlert, IonButton, IonCol, IonContent, IonGrid, IonItemDivider, IonLabel, IonLoading, IonModal, IonRow, IonTextarea } from '@ionic/react';\nimport React, { useEffect, useState } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCommentDots, faEdit } from '@fortawesome/free-regular-svg-icons';\nimport { faTrash } from '@fortawesome/free-solid-svg-icons';\nimport \"../../css/Global.css\";\nimport \"../../css/Forum.css\";\nimport { db } from '../../firebase';\nimport { useAuth } from '../../modules/auth';\n\nconst ForumQuestions = props => {\n  const {\n    userID\n  } = useAuth();\n  const [loading, setLoading] = useState(false);\n  const [showEditCommentModal, setShowEditCommentModal] = useState(false);\n  const [deleteAlert, setDeleteAlert] = useState({\n    alert: false,\n    loading: false\n  });\n  const [comments, setComments] = useState([]);\n  const [entry, setEntry] = useState(\"\");\n  const [toBeEdited, setToBeEdited] = useState(0);\n  const [toBeDeleted, setToBeDeleted] = useState(0);\n\n  const handleDelete = async postId => {\n    try {\n      setDeleteAlert({\n        alert: false,\n        loading: true\n      });\n      await db.collection('Forum').doc(userID).collection('Comments').doc(postId).update({\n        deleted: true\n      });\n    } catch (e) {\n      return console.log(e);\n    } finally {\n      setDeleteAlert({\n        alert: false,\n        loading: false\n      });\n    }\n  };\n\n  const handleEdit = async postId => {\n    try {\n      setLoading(true);\n      await db.collection('Forum').doc(userID).collection('Comments').doc(postId).update({\n        entry: entry\n      });\n    } catch (e) {\n      return console.log(e);\n    } finally {\n      setShowEditCommentModal(false);\n      setLoading(false);\n      setEntry(\"\");\n    }\n  };\n\n  useEffect(() => {\n    return db.collection('Forum').doc(userID).collection('Comments').where(\"deleted\", \"==\", false).onSnapshot(snaps => {\n      const posts = [];\n      snaps.forEach(async snap => {\n        let post = { ...snap.data()\n        };\n        await db.collection('Forum').get().then(users => {\n          users.forEach(user => {\n            return db.collection('Forum').doc(user.id).collection('Questions').doc(snap.data().questionId.toString()).onSnapshot(question => {\n              if (question.exists) {\n                var _question$data, _question$data2;\n\n                post.question = (_question$data = question.data()) === null || _question$data === void 0 ? void 0 : _question$data.entry;\n                post.questionRemoved = (_question$data2 = question.data()) === null || _question$data2 === void 0 ? void 0 : _question$data2.deleted;\n              }\n            });\n          });\n        });\n        posts.push(post);\n      });\n      setTimeout(() => {\n        setComments(posts);\n        setLoading(false);\n      }, 500);\n    });\n  }, []);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(IonGrid, {\n    id: \"forumQnsCom-tableGrid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonRow, {\n    id: \"forumQnsCom-tableHeader\",\n    className: \"ion-justify-content-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(IonCol, {\n    className: \"forumQnsCom-Header ion-text-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 21\n    }\n  }, \"Question\"), /*#__PURE__*/React.createElement(IonCol, {\n    className: \"forumQnsCom-Header ion-text-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 21\n    }\n  }, \"My Comment\"), /*#__PURE__*/React.createElement(IonCol, {\n    className: \"forumQnsCom-Header ion-text-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 21\n    }\n  }, \"Posted Date/Time\"), /*#__PURE__*/React.createElement(IonCol, {\n    className: \"forumQnsCom-Header ion-text-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(IonRow, {\n    className: \"ion-justify-content-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 74\n    }\n  }, \"No. of\"), /*#__PURE__*/React.createElement(IonRow, {\n    className: \"ion-justify-content-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 136\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faCommentDots,\n    size: \"lg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 183\n    }\n  }))), /*#__PURE__*/React.createElement(IonCol, {\n    className: \"forumQnsCom-Header ion-text-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 21\n    }\n  }, \"Edit Comment\"), /*#__PURE__*/React.createElement(IonCol, {\n    className: \"forumQnsCom-Header ion-text-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 21\n    }\n  }, \"Delete Comment\")), comments.map(post => /*#__PURE__*/React.createElement(IonRow, {\n    className: \"ion-justify-content-center\",\n    key: post.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(IonCol, {\n    className: \"forumQnsCom-Data ion-text-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 25\n    }\n  }, post.questionRemoved === false ? post.question : \"[deleted]\"), /*#__PURE__*/React.createElement(IonCol, {\n    className: \"forumQnsCom-Data ion-text-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 25\n    }\n  }, post.entry), /*#__PURE__*/React.createElement(IonCol, {\n    className: \"forumQnsCom-Data ion-text-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 25\n    }\n  }, post.dateTime), /*#__PURE__*/React.createElement(IonCol, {\n    className: \"forumQnsCom-Data ion-text-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 25\n    }\n  }, post.hasOwnProperty('commentId') === false ? post.noOfReplies : \"-\"), /*#__PURE__*/React.createElement(IonCol, {\n    className: \"forumQnsCom-Data ion-text-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(IonButton, {\n    onClick: () => [setShowEditCommentModal(true), setToBeEdited(post.id)],\n    className: \"forumQnsCom-DataBtn\",\n    size: \"small\",\n    style: {\n      marginTop: \"-5%\",\n      marginBottom: \"-5%\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faEdit,\n    size: \"lg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 207\n    }\n  }))), /*#__PURE__*/React.createElement(IonCol, {\n    className: \"forumQnsCom-Data ion-text-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(IonButton, {\n    onClick: () => [setDeleteAlert({\n      alert: true,\n      loading: false\n    }), setToBeDeleted(post.id)],\n    className: \"forumQnsCom-DataBtn\",\n    size: \"small\",\n    style: {\n      marginTop: \"-5%\",\n      marginBottom: \"-5%\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faTrash,\n    size: \"lg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 226\n    }\n  })))))), /*#__PURE__*/React.createElement(IonModal, {\n    isOpen: showEditCommentModal,\n    cssClass: \"post-question-modal\",\n    onDidDismiss: () => setShowEditCommentModal(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(IonGrid, {\n    id: \"postQns-modal-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(IonRow, {\n    style: {\n      paddingTop: '1%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(IonLabel, {\n    id: \"postQns-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 29\n    }\n  }, \"Edit Comment\")), /*#__PURE__*/React.createElement(IonItemDivider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(IonRow, {\n    id: \"postQns-modal-inputArea\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(IonTextarea, {\n    rows: 11,\n    contentEditable: true,\n    value: entry,\n    onIonChange: e => setEntry(e.detail.value),\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(IonRow, {\n    className: \"ion-justify-content-around\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(IonButton, {\n    id: \"postQns-close-button\",\n    fill: \"outline\",\n    onClick: () => setShowEditCommentModal(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 29\n    }\n  }, \"CANCEL\"), /*#__PURE__*/React.createElement(IonButton, {\n    id: \"postQns-post-button\",\n    onClick: () => handleEdit(toBeEdited.toString()),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 29\n    }\n  }, \"UPDATE\"))))), /*#__PURE__*/React.createElement(IonAlert, {\n    isOpen: deleteAlert.alert,\n    cssClass: \"alertBox\",\n    header: 'Delete Comment',\n    message: 'Are you sure you want to delete the comment?',\n    buttons: [{\n      text: 'NO',\n      handler: () => setDeleteAlert({\n        alert: false,\n        loading: false\n      })\n    }, {\n      text: 'YES',\n      handler: () => handleDelete(toBeDeleted.toString())\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(IonLoading, {\n    isOpen: deleteAlert.loading || loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 13\n    }\n  }));\n};\n\nexport default ForumQuestions;","map":{"version":3,"sources":["D:/BearBear/Coding_Projects/UOW-CSIT321 (FYP)/FYP20S313-Mobile/SIM-OpenHouse/src/components/Forum/ForumComments.tsx"],"names":["IonAlert","IonButton","IonCol","IonContent","IonGrid","IonItemDivider","IonLabel","IonLoading","IonModal","IonRow","IonTextarea","React","useEffect","useState","FontAwesomeIcon","faCommentDots","faEdit","faTrash","db","useAuth","ForumQuestions","props","userID","loading","setLoading","showEditCommentModal","setShowEditCommentModal","deleteAlert","setDeleteAlert","alert","comments","setComments","entry","setEntry","toBeEdited","setToBeEdited","toBeDeleted","setToBeDeleted","handleDelete","postId","collection","doc","update","deleted","e","console","log","handleEdit","where","onSnapshot","snaps","posts","forEach","snap","post","data","get","then","users","user","id","questionId","toString","question","exists","questionRemoved","push","setTimeout","map","dateTime","hasOwnProperty","noOfReplies","marginTop","marginBottom","paddingTop","detail","value","text","handler"],"mappings":"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","sourcesContent":["import { IonAlert, IonButton, IonCol, IonContent, IonGrid, IonItemDivider, IonLabel, IonLoading, IonModal, IonRow, IonTextarea } from '@ionic/react';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faCommentDots, faEdit } from '@fortawesome/free-regular-svg-icons';\r\nimport { faTrash } from '@fortawesome/free-solid-svg-icons';\r\n\r\nimport \"../../css/Global.css\";\r\nimport \"../../css/Forum.css\";\r\nimport { db } from '../../firebase';\r\nimport { useAuth } from '../../modules/auth';\r\n\r\nconst ForumQuestions: React.FC<{ comments: any[] }> = (props) => {\r\n    const { userID } = useAuth();\r\n\r\n    const [loading, setLoading] = useState(false);\r\n    const [showEditCommentModal, setShowEditCommentModal] = useState(false);\r\n    const [deleteAlert, setDeleteAlert] = useState({ alert: false, loading: false });\r\n    const [comments, setComments] = useState([]);\r\n    const [entry, setEntry] = useState(\"\");\r\n    const [toBeEdited, setToBeEdited] = useState(0);\r\n    const [toBeDeleted, setToBeDeleted] = useState(0);\r\n\r\n    const handleDelete = async (postId: string) => {\r\n        try {\r\n            setDeleteAlert({ alert: false, loading: true });\r\n            await db.collection('Forum').doc(userID).collection('Comments').doc(postId).update({\r\n                deleted: true\r\n            });\r\n        } catch (e) {\r\n            return console.log(e);\r\n        } finally {\r\n            setDeleteAlert({ alert: false, loading: false });\r\n        }\r\n    }\r\n\r\n    const handleEdit = async (postId: string) => {\r\n        try {\r\n            setLoading(true);\r\n            await db.collection('Forum').doc(userID).collection('Comments').doc(postId).update({\r\n                entry: entry\r\n            });\r\n        } catch (e) {\r\n            return console.log(e);\r\n        } finally {\r\n            setShowEditCommentModal(false);\r\n            setLoading(false);\r\n            setEntry(\"\");\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        return db.collection('Forum').doc(userID).collection('Comments').where(\"deleted\", \"==\", false).onSnapshot(snaps => {\r\n            const posts: any = [];\r\n            \r\n            snaps.forEach(async (snap) => {\r\n                let post: any = { ...snap.data() }\r\n\r\n                await db.collection('Forum').get().then(users => {\r\n                    users.forEach(user => {\r\n                        return db.collection('Forum').doc(user.id).collection('Questions').doc(snap.data().questionId.toString()).onSnapshot(question => {\r\n                            if(question.exists) {\r\n                                post.question = question.data()?.entry;\r\n                                post.questionRemoved = question.data()?.deleted;\r\n                            }\r\n                        });\r\n                    });\r\n                });\r\n                posts.push(post)\r\n            });\r\n\r\n            setTimeout(() => {\r\n                setComments(posts);\r\n                setLoading(false);\r\n            }, 500);\r\n        });\r\n    }, []);\r\n\r\n    return (\r\n        <>\r\n            <IonGrid id=\"forumQnsCom-tableGrid\">\r\n                <IonRow id=\"forumQnsCom-tableHeader\" className=\"ion-justify-content-center\">\r\n                    <IonCol className=\"forumQnsCom-Header ion-text-wrap\">Question</IonCol>\r\n                    <IonCol className=\"forumQnsCom-Header ion-text-wrap\">My Comment</IonCol>\r\n                    <IonCol className=\"forumQnsCom-Header ion-text-wrap\">Posted Date/Time</IonCol>\r\n                    <IonCol className=\"forumQnsCom-Header ion-text-wrap\"><IonRow className=\"ion-justify-content-center\">No. of</IonRow><IonRow className=\"ion-justify-content-center\"><FontAwesomeIcon icon={faCommentDots} size=\"lg\" /></IonRow></IonCol>\r\n                    <IonCol className=\"forumQnsCom-Header ion-text-wrap\">Edit Comment</IonCol>\r\n                    <IonCol className=\"forumQnsCom-Header ion-text-wrap\">Delete Comment</IonCol>\r\n                </IonRow>\r\n                {comments.map((post: any) => (\r\n                    <IonRow className=\"ion-justify-content-center\" key={post.id}>\r\n                        <IonCol className=\"forumQnsCom-Data ion-text-wrap\">{post.questionRemoved === false ? post.question : \"[deleted]\"}</IonCol>\r\n                        <IonCol className=\"forumQnsCom-Data ion-text-wrap\">{post.entry}</IonCol>\r\n                        <IonCol className=\"forumQnsCom-Data ion-text-wrap\">{post.dateTime}</IonCol>\r\n                        <IonCol className=\"forumQnsCom-Data ion-text-wrap\">{post.hasOwnProperty('commentId') === false ? post.noOfReplies : \"-\"}</IonCol>\r\n                        <IonCol className=\"forumQnsCom-Data ion-text-wrap\">\r\n                            {/* <Forum_EditCommentModal /> */}\r\n                            <IonButton onClick={() => [setShowEditCommentModal(true), setToBeEdited(post.id)]} className=\"forumQnsCom-DataBtn\" size=\"small\" style={{ marginTop: \"-5%\", marginBottom: \"-5%\" }}><FontAwesomeIcon icon={faEdit} size=\"lg\" /></IonButton>\r\n                        </IonCol>\r\n                        <IonCol className=\"forumQnsCom-Data ion-text-wrap\">\r\n                            {/* <Forum_DeleteComment /> */}\r\n                            <IonButton onClick={() => [setDeleteAlert({ alert: true, loading: false }), setToBeDeleted(post.id)]} className=\"forumQnsCom-DataBtn\" size=\"small\" style={{ marginTop: \"-5%\", marginBottom: \"-5%\" }}><FontAwesomeIcon icon={faTrash} size=\"lg\" /></IonButton>\r\n                        </IonCol>\r\n                    </IonRow>\r\n                ))}\r\n            </IonGrid>\r\n            <IonModal isOpen={showEditCommentModal} cssClass='post-question-modal' onDidDismiss={() => setShowEditCommentModal(false)}>\r\n                <IonContent>\r\n                    <IonGrid id=\"postQns-modal-container\">\r\n                        <IonRow style={{ paddingTop: '1%' }}>\r\n                            <IonLabel id=\"postQns-title\">Edit Comment</IonLabel>\r\n                        </IonRow>\r\n                        <IonItemDivider />\r\n                        <IonRow id=\"postQns-modal-inputArea\">\r\n                            <IonTextarea rows={11} contentEditable={true} value={entry} onIonChange={e => setEntry(e.detail.value!)} required></IonTextarea>\r\n                        </IonRow>\r\n                        <IonRow className=\"ion-justify-content-around\">\r\n                            <IonButton id=\"postQns-close-button\" fill=\"outline\" onClick={() => setShowEditCommentModal(false)}>CANCEL</IonButton>\r\n                            <IonButton id=\"postQns-post-button\" onClick={() => handleEdit(toBeEdited.toString())}>UPDATE</IonButton>\r\n                        </IonRow>\r\n                    </IonGrid>\r\n                </IonContent>\r\n            </IonModal>\r\n\r\n            {/* Delete Comment Alert */}\r\n            <IonAlert\r\n                isOpen={deleteAlert.alert}\r\n                cssClass='alertBox' header={'Delete Comment'}\r\n                message={'Are you sure you want to delete the comment?'}\r\n                buttons={[\r\n                    {\r\n                        text: 'NO',\r\n                        handler: () => setDeleteAlert({ alert: false, loading: false })\r\n                    }, {\r\n                        text: 'YES',\r\n                        handler: () => handleDelete(toBeDeleted.toString())\r\n                    }]}\r\n            ></IonAlert>\r\n            <IonLoading isOpen={deleteAlert.loading || loading} />\r\n        </>\r\n    );\r\n};\r\n\r\nexport default ForumQuestions;"]},"metadata":{},"sourceType":"module"}