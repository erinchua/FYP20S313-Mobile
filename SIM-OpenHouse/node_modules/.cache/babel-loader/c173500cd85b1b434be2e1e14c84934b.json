{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import{IonCol,IonContent,IonGrid,IonHeader,IonLabel,IonPage,IonRow,IonTitle}from'@ionic/react';import React,{useEffect,useState}from'react';import'../css/Global.css';import'../css/Announcements.css';import TopNav from'../components/TopNav';import{db}from'../firebase';import{toAnnouncement}from'../modules/map';import{toDateObject}from'../modules/convert';import{sortTimeAsc}from'../modules/compare';import notification from'../modules/Notifications';var Announcements=function Announcements(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),announcements=_useState2[0],setAnnouncements=_useState2[1];var current=announcements.filter(function(news){return new Date().getTime()>toDateObject(news.date,news.time).getTime();}).sort(function(a,b){return sortTimeAsc(a.time,b.time);});announcements.map(function(alert){return notification(alert.date,alert.time,alert.title,\"announcement\");});useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return db.collection('Announcements').get().then(function(_ref2){var docs=_ref2.docs;setAnnouncements(docs.map(toAnnouncement));});case 2:case\"end\":return _context.stop();}}},_callee);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[]);//console.log(current)\nreturn/*#__PURE__*/React.createElement(IonPage,null,/*#__PURE__*/React.createElement(IonHeader,null,/*#__PURE__*/React.createElement(TopNav,{title:\"Announcements\",route:\"/u/home\",backarrow:true,hamburger:true})),/*#__PURE__*/React.createElement(IonContent,{fullscreen:true},current.length>0?/*#__PURE__*/React.createElement(IonGrid,{id:\"announcementGrid\"},current.map(function(news){var day=toDateObject(news.date,news.time).toDateString().split(\" \")[0];return/*#__PURE__*/React.createElement(IonRow,{className:\"announcementRow\",key:news.id},/*#__PURE__*/React.createElement(IonCol,{className:\"announcementColDetails\"},/*#__PURE__*/React.createElement(IonRow,null,/*#__PURE__*/React.createElement(IonTitle,{id:\"announcementTitle\"},news.title)),/*#__PURE__*/React.createElement(IonRow,null,/*#__PURE__*/React.createElement(IonLabel,{id:\"announcementDate\"},\"Posted on \",news.date,\" (\",day,\"), \",news.time)),/*#__PURE__*/React.createElement(IonRow,null,/*#__PURE__*/React.createElement(IonLabel,{id:\"announcementDetails\"},news.details))));})):/*#__PURE__*/React.createElement(IonGrid,{id:\"noAnnouncementGrid\"},/*#__PURE__*/React.createElement(IonRow,{id:\"noAnnouncementRow\",class:\"ion-align-items-center\"},/*#__PURE__*/React.createElement(IonCol,{id:\"noAnnnouncementCol\",class:\"ion-text-center\"},/*#__PURE__*/React.createElement(IonTitle,{id:\"noAnnouncementTitle\"},\"There are currently no announcements\"))))));};export default Announcements;","map":{"version":3,"sources":["D:/BearBear/Coding_Projects/UOW-CSIT321 (FYP)/FYP20S313-Mobile/SIM-OpenHouse/src/pages/Announcements.tsx"],"names":["IonCol","IonContent","IonGrid","IonHeader","IonLabel","IonPage","IonRow","IonTitle","React","useEffect","useState","TopNav","db","toAnnouncement","toDateObject","sortTimeAsc","notification","Announcements","announcements","setAnnouncements","current","filter","news","Date","getTime","date","time","sort","a","b","map","alert","title","fetchData","collection","get","then","docs","length","day","toDateString","split","id","details"],"mappings":"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","sourcesContent":["import { IonCol, IonContent, IonGrid, IonHeader, IonLabel, IonPage, IonRow, IonTitle } from '@ionic/react';\r\nimport React, { useEffect, useState } from 'react';\r\n\r\nimport '../css/Global.css';\r\nimport '../css/Announcements.css';\r\nimport TopNav from '../components/TopNav';\r\nimport { db } from '../firebase';\r\nimport { Announcement, toAnnouncement } from '../modules/map';\r\nimport { toDateObject } from '../modules/convert';\r\nimport { sortTimeAsc } from '../modules/compare';\r\nimport notification from '../modules/Notifications';\r\n\r\n\r\nconst Announcements: React.FC = () => {\r\n\r\n    const [announcements, setAnnouncements] = useState<Announcement[]>([]);\r\n\r\n    const current = announcements.filter(news => { return new Date().getTime() > toDateObject(news.date, news.time).getTime() }).sort((a, b) => sortTimeAsc(a.time, b.time));\r\n    announcements.map(alert => notification(alert.date, alert.time, alert.title, \"announcement\"));\r\n\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            await db.collection('Announcements').get().then(({ docs }) => {\r\n                setAnnouncements(docs.map(toAnnouncement));\r\n            });\r\n        }\r\n        fetchData();\r\n    }, []);\r\n\r\n    //console.log(current)\r\n\r\n    return (\r\n        <IonPage>\r\n            <IonHeader>\r\n                <TopNav title=\"Announcements\" route='/u/home' backarrow={true} hamburger={true} />\r\n            </IonHeader>\r\n\r\n            <IonContent fullscreen={true}>\r\n                {current.length > 0 ? (\r\n                    <IonGrid id=\"announcementGrid\">\r\n\r\n                        {current.map(news => {\r\n                            const day = toDateObject(news.date, news.time).toDateString().split(\" \")[0];\r\n\r\n                            return (\r\n                                <IonRow className=\"announcementRow\" key={news.id}>\r\n                                    <IonCol className=\"announcementColDetails\">\r\n                                        <IonRow>\r\n                                            <IonTitle id=\"announcementTitle\">{news.title}</IonTitle>\r\n                                        </IonRow>\r\n\r\n                                        <IonRow>\r\n                                            <IonLabel id=\"announcementDate\">Posted on {news.date} ({day}), {news.time}</IonLabel>\r\n                                        </IonRow>\r\n\r\n                                        <IonRow>\r\n                                            <IonLabel id=\"announcementDetails\">{news.details}</IonLabel>\r\n                                        </IonRow>\r\n                                    </IonCol>\r\n                                </IonRow>\r\n                            )\r\n                        })}\r\n                        \r\n                    </IonGrid>\r\n                ) : (\r\n                    <IonGrid id=\"noAnnouncementGrid\">\r\n                        <IonRow id=\"noAnnouncementRow\" class=\"ion-align-items-center\">\r\n                            <IonCol id=\"noAnnnouncementCol\" class=\"ion-text-center\">\r\n                                <IonTitle id=\"noAnnouncementTitle\">There are currently no announcements</IonTitle>\r\n                            </IonCol>\r\n                        </IonRow>\r\n                    </IonGrid>\r\n                )}\r\n            </IonContent>\r\n        </IonPage>\r\n    );\r\n\r\n};\r\n\r\nexport default Announcements;"]},"metadata":{},"sourceType":"module"}