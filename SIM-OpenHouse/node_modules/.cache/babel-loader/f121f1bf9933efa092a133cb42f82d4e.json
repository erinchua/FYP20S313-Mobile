{"ast":null,"code":"var _jsxFileName = \"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\src\\\\pages\\\\Forum\\\\ForumSearch.tsx\";\nimport { IonContent, IonPage, IonGrid, IonRow, IonCol, IonHeader, IonTitle, IonLoading, IonList, IonLabel, IonRouterLink, IonText } from '@ionic/react';\nimport React, { useEffect, useState } from 'react';\nimport { useParams } from 'react-router';\nimport { faClock, faCommentAlt } from '@fortawesome/free-regular-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport '../../css/Global.css';\nimport '../../css/Forum.css';\nimport TopNav from '../../components/TopNav';\nimport ForumRules from '../../components/Forum/ForumRules';\nimport Forum_FlagModal from '../../components/Forum/Forum_FlagModal';\nimport { db } from '../../firebase';\n\nconst ForumSearch = () => {\n  const {\n    keyword\n  } = useParams();\n  const [loading, setLoading] = useState(true);\n  const [searchResults, setSearchResults] = useState([]);\n\n  const getSearchResults = allPosts => {\n    const matchedPosts = [];\n    allPosts.forEach(post => {\n      if (post.entry.toLowerCase().indexOf(keyword.toLowerCase()) !== -1) {\n        if (post.hasOwnProperty('questionId')) {\n          allPosts.forEach(ele => {\n            if (ele.id === post.questionId) {\n              post = ele;\n            }\n          });\n        }\n\n        if (!(matchedPosts.filter(result => {\n          return post.id === result.id;\n        }).length > 0)) matchedPosts.push(post);\n      }\n    });\n    return setSearchResults(matchedPosts);\n  };\n\n  useEffect(() => {\n    db.collection('Forum').get().then(users => {\n      const all = [];\n      users.forEach(async user => {\n        await db.collection('Forum').doc(user.id).collection('Questions').get().then(docs => {\n          docs.forEach(doc => {\n            all.push({\n              id: +doc.id,\n              entry: doc.data().entry,\n              dateTime: doc.data().dateTime,\n              user: doc.data().posterName,\n              uid: doc.data().posterId,\n              commentCount: doc.data().noOfComments,\n              removed: doc.data().deleted\n            });\n          });\n        });\n        await db.collection('Forum').doc(user.id).collection('Comments').get().then(docs => {\n          docs.forEach(doc => {\n            all.push({\n              id: +doc.id,\n              entry: doc.data().entry,\n              questionId: +doc.data().questionId\n            });\n          });\n        });\n      });\n      setTimeout(() => {\n        getSearchResults(all);\n        setLoading(false);\n      }, 500);\n    });\n  }, []);\n  return /*#__PURE__*/React.createElement(IonPage, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(IonHeader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(TopNav, {\n    title: \"Forum\",\n    route: \"/u/forum\",\n    backarrow: true,\n    hamburger: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(IonContent, {\n    fullscreen: true,\n    id: \"forum-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonGrid, {\n    id: \"forum-heading-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(IonRow, {\n    className: \"ion-justify-content-start\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(IonCol, {\n    size: \"10\",\n    className: \"ion-align-self-center forum-col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(IonTitle, {\n    id: \"forum-heading\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 29\n    }\n  }, \"Search Results for: \", /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      color: 'black'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 78\n    }\n  }, keyword))), /*#__PURE__*/React.createElement(IonCol, {\n    size: \"2\",\n    className: \"forum-col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(ForumRules, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 29\n    }\n  })))), searchResults.length > 0 ? searchResults.map(result => result.removed === false ? /*#__PURE__*/React.createElement(IonList, {\n    className: \"forum-container\",\n    key: result.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(IonGrid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(IonRouterLink, {\n    href: `/u/forumViewQuestion/${result.id}/${result.uid}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(IonRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(IonLabel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 45\n    }\n  }, /*#__PURE__*/React.createElement(IonText, {\n    className: \"forum-question\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 49\n    }\n  }, result.entry))), /*#__PURE__*/React.createElement(IonRow, {\n    className: \"ion-justify-content-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(IonText, {\n    className: \"forum-question-details\",\n    id: \"forum-userName\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 45\n    }\n  }, \"~ \", result.user))), /*#__PURE__*/React.createElement(IonRow, {\n    className: \"ion-align-items-end ion-justify-content-start\",\n    id: \"forum-question-detail-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(IonCol, {\n    size: \"1\",\n    className: \"forum-col ion-align-self-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faClock,\n    size: \"sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 45\n    }\n  })), /*#__PURE__*/React.createElement(IonCol, {\n    size: \"6\",\n    className: \"forum-col ion-align-self-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(IonText, {\n    className: \"forum-question-details\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 45\n    }\n  }, result.dateTime)), /*#__PURE__*/React.createElement(IonCol, {\n    size: \"1\",\n    className: \"forum-col ion-align-self-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faCommentAlt,\n    size: \"sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 45\n    }\n  })), /*#__PURE__*/React.createElement(IonCol, {\n    size: \"3\",\n    className: \"forum-col ion-align-self-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(IonText, {\n    className: \"forum-question-details\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 45\n    }\n  }, result.commentCount)), /*#__PURE__*/React.createElement(IonCol, {\n    size: \"1\",\n    className: \"ion-align-self-end forum-col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 41\n    }\n  }, /*#__PURE__*/React.createElement(Forum_FlagModal, {\n    disabled: false,\n    postId: result.id,\n    postType: \"Question\",\n    postContent: result.entry,\n    offender: result.user,\n    offenderId: result.uid,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 45\n    }\n  }))))) : null) : /*#__PURE__*/React.createElement(IonGrid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(IonRow, {\n    className: \"ion-justify-content-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(IonText, {\n    color: \"medium\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 33\n    }\n  }, \"No match was found\"))), /*#__PURE__*/React.createElement(IonLoading, {\n    isOpen: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 17\n    }\n  })));\n};\n\nexport default ForumSearch;","map":{"version":3,"sources":["D:/BearBear/Coding_Projects/UOW-CSIT321 (FYP)/FYP20S313-Mobile/SIM-OpenHouse/src/pages/Forum/ForumSearch.tsx"],"names":["IonContent","IonPage","IonGrid","IonRow","IonCol","IonHeader","IonTitle","IonLoading","IonList","IonLabel","IonRouterLink","IonText","React","useEffect","useState","useParams","faClock","faCommentAlt","FontAwesomeIcon","TopNav","ForumRules","Forum_FlagModal","db","ForumSearch","keyword","loading","setLoading","searchResults","setSearchResults","getSearchResults","allPosts","matchedPosts","forEach","post","entry","toLowerCase","indexOf","hasOwnProperty","ele","id","questionId","filter","result","length","push","collection","get","then","users","all","user","doc","docs","data","dateTime","posterName","uid","posterId","commentCount","noOfComments","removed","deleted","setTimeout","color","map"],"mappings":"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","sourcesContent":["import { IonContent, IonPage, IonGrid, IonRow, IonCol, IonHeader, IonTitle, IonLoading, IonList, IonLabel, IonRouterLink, IonText } from '@ionic/react';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useParams } from 'react-router';\r\nimport { faClock, faCommentAlt } from '@fortawesome/free-regular-svg-icons';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\n\r\nimport '../../css/Global.css';\r\nimport '../../css/Forum.css';\r\nimport TopNav from '../../components/TopNav';\r\nimport ForumRules from '../../components/Forum/ForumRules';\r\nimport Forum_FlagModal from '../../components/Forum/Forum_FlagModal';\r\nimport { db } from '../../firebase';\r\n\r\ninterface RouteParams {\r\n    keyword: string;\r\n}\r\n\r\nconst ForumSearch: React.FC = () => {\r\n    const { keyword } = useParams<RouteParams>();\r\n\r\n    const [loading, setLoading] = useState(true);\r\n    const [searchResults, setSearchResults] = useState([]);\r\n\r\n    const getSearchResults = (allPosts: any) => {\r\n        const matchedPosts: any = [];\r\n\r\n        allPosts.forEach((post: any) => {\r\n            if (post.entry.toLowerCase().indexOf(keyword.toLowerCase()) !== -1) {\r\n                if (post.hasOwnProperty('questionId')) {\r\n                    allPosts.forEach((ele: any) => {\r\n                        if (ele.id === post.questionId) {\r\n                            post = ele;\r\n                        }\r\n                    });\r\n                }\r\n                if (!(matchedPosts.filter((result: any) => { return post.id === result.id }).length > 0))\r\n                    matchedPosts.push(post);\r\n            }\r\n        });\r\n\r\n        return setSearchResults(matchedPosts);\r\n    }\r\n\r\n    useEffect(() => {\r\n        db.collection('Forum').get().then(users => {\r\n            const all: any = [];\r\n\r\n            users.forEach(async user => {\r\n                await db.collection('Forum').doc(user.id).collection('Questions').get().then(docs => {\r\n                    docs.forEach(doc => {\r\n                        all.push({\r\n                            id: +doc.id,\r\n                            entry: doc.data().entry,\r\n                            dateTime: doc.data().dateTime,\r\n                            user: doc.data().posterName,\r\n                            uid: doc.data().posterId,\r\n                            commentCount: doc.data().noOfComments,\r\n                            removed: doc.data().deleted\r\n                        });\r\n                    });\r\n                });\r\n                \r\n                await db.collection('Forum').doc(user.id).collection('Comments').get().then(docs => {\r\n                    docs.forEach(doc => {\r\n                        all.push({\r\n                            id: +doc.id,\r\n                            entry: doc.data().entry,\r\n                            questionId: +doc.data().questionId\r\n                        });\r\n                    });\r\n                });\r\n            });\r\n\r\n            setTimeout(() => {\r\n                getSearchResults(all);\r\n                setLoading(false);\r\n            }, 500);\r\n        });\r\n    }, []);\r\n\r\n    return (\r\n        <IonPage>\r\n            <IonHeader>\r\n                <TopNav title=\"Forum\" route=\"/u/forum\" backarrow={ true } hamburger={ true }/>\r\n            </IonHeader>\r\n\r\n            <IonContent  fullscreen id=\"forum-content\">\r\n                <IonGrid id=\"forum-heading-container\">\r\n                    <IonRow className=\"ion-justify-content-start\">\r\n                        <IonCol size=\"10\" className=\"ion-align-self-center forum-col\">\r\n                            <IonTitle id=\"forum-heading\">Search Results for: <span style={{color: 'black'}}>{keyword}</span></IonTitle>\r\n                        </IonCol>                            \r\n                        <IonCol size=\"2\" className=\"forum-col\">\r\n                            <ForumRules />\r\n                        </IonCol>\r\n                    </IonRow>\r\n                </IonGrid>\r\n\r\n                {searchResults.length > 0 ?\r\n                    searchResults.map((result: any) => (\r\n                        result.removed === false ? (\r\n                            <IonList className=\"forum-container\" key={result.id}>\r\n                                <IonGrid>\r\n                                    <IonRouterLink href={`/u/forumViewQuestion/${result.id}/${result.uid}`}>\r\n                                        <IonRow>\r\n                                            <IonLabel>\r\n                                                <IonText className=\"forum-question\">{result.entry}</IonText>\r\n                                            </IonLabel>\r\n                                        </IonRow>\r\n                                        <IonRow className=\"ion-justify-content-end\">\r\n                                            <IonText className=\"forum-question-details\" id=\"forum-userName\">~ {result.user}</IonText>\r\n                                        </IonRow>\r\n                                    </IonRouterLink>\r\n                                    <IonRow className=\"ion-align-items-end ion-justify-content-start\" id=\"forum-question-detail-container\">\r\n                                        <IonCol size=\"1\" className=\"forum-col ion-align-self-end\">\r\n                                            <FontAwesomeIcon icon={faClock} size=\"sm\" />\r\n                                        </IonCol>\r\n                                        <IonCol size=\"6\" className=\"forum-col ion-align-self-end\">\r\n                                            <IonText className=\"forum-question-details\">{result.dateTime}</IonText>\r\n                                        </IonCol>\r\n                                        <IonCol size=\"1\" className=\"forum-col ion-align-self-end\">\r\n                                            <FontAwesomeIcon icon={faCommentAlt} size=\"sm\" />\r\n                                        </IonCol>\r\n                                        <IonCol size=\"3\" className=\"forum-col ion-align-self-end\">\r\n                                            <IonText className=\"forum-question-details\">{result.commentCount}</IonText>\r\n                                        </IonCol>\r\n                                        <IonCol size=\"1\" className=\"ion-align-self-end forum-col\">\r\n                                            <Forum_FlagModal disabled={false} postId={result.id} postType={\"Question\"} postContent={result.entry} offender={result.user} offenderId={result.uid} />\r\n                                        </IonCol>\r\n                                    </IonRow>\r\n                                </IonGrid>\r\n                            </IonList>\r\n                        ) : null\r\n                    )) : (\r\n                        <IonGrid>\r\n                            <IonRow className=\"ion-justify-content-center\">\r\n                                <IonText color=\"medium\">No match was found</IonText>\r\n                            </IonRow>\r\n                        </IonGrid>\r\n                    )\r\n                }\r\n                <IonLoading isOpen={loading} />\r\n            </IonContent>\r\n        </IonPage>\r\n    );\r\n};\r\n\r\nexport default ForumSearch;"]},"metadata":{},"sourceType":"module"}