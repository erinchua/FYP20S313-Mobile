{"ast":null,"code":"var _jsxFileName = \"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\src\\\\pages\\\\Forum\\\\ForumViewQuestion.tsx\";\nimport { IonContent, IonPage, IonGrid, IonRow, IonSearchbar, IonCol, IonList, IonLabel, IonText, IonHeader, IonLoading, IonButton, IonItemDivider, IonModal, IonTextarea } from '@ionic/react';\nimport React, { useEffect, useState } from 'react';\nimport { useHistory, useParams } from 'react-router';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faClock, faComment, faCommentAlt, faCommentDots } from '@fortawesome/free-regular-svg-icons';\nimport firebase from 'firebase';\nimport '../../css/Global.css';\nimport '../../css/Forum.css';\nimport TopNav from '../../components/TopNav';\nimport ForumRules from '../../components/Forum/ForumRules';\nimport Forum_FlagModal from '../../components/Forum/Forum_FlagModal';\nimport { db } from '../../firebase';\nimport { useAuth } from '../../modules/auth';\nimport { forumPostsAsc } from '../../modules/compare';\n\nconst ForumViewQuestion = () => {\n  const {\n    id,\n    uid\n  } = useParams();\n  const {\n    userID\n  } = useAuth();\n  let history = useHistory();\n  const [loading, setLoading] = useState(true);\n  const [showAddCommentModal, setShowAddCommentModal] = useState(false);\n  const [showReplyCommentModal, setShowReplyCommentModal] = useState(false);\n  const [question, setQuestion] = useState({});\n  const [entry, setEntry] = useState(\"\");\n  const [comments, setComments] = useState([]);\n  const [commentDetails, setCommentDetails] = useState({\n    commenter: \"\",\n    commentId: 0,\n    commenterId: 0\n  });\n  const [keyword, setKeyword] = useState(\"\");\n\n  const handleComment = async () => {\n    try {\n      setLoading(true);\n      const time = new Date();\n      let name;\n\n      if (entry !== \"\") {\n        await db.collection('Students').doc(userID).get().then(doc => {\n          var _doc$data, _doc$data2;\n\n          if (doc.exists) name = ((_doc$data = doc.data()) === null || _doc$data === void 0 ? void 0 : _doc$data.firstName) + \" \" + ((_doc$data2 = doc.data()) === null || _doc$data2 === void 0 ? void 0 : _doc$data2.lastName);\n        });\n        const docRef = db.collection('Forum').doc(userID).collection('Comments').doc(time.getTime().toString());\n        await docRef.set({\n          id: +docRef.id,\n          entry: entry,\n          questionId: +id,\n          posterName: name,\n          posterId: userID,\n          dateTime: time.toLocaleString().replace(/\\//g, \"-\"),\n          deleted: false,\n          reported: false,\n          noOfReplies: 0\n        });\n        const increment = firebase.firestore.FieldValue.increment(1);\n        await db.collection('Forum').doc(uid).collection('Questions').doc(id).update({\n          noOfComments: increment\n        });\n      }\n    } catch (e) {\n      return console.log(e);\n    } finally {\n      setLoading(false);\n      setShowAddCommentModal(false);\n      setEntry(\"\");\n    }\n  };\n\n  const handleReply = async (commentId, commenterId) => {\n    try {\n      setLoading(true);\n      const time = new Date();\n      let name;\n      await db.collection('Students').doc(userID).get().then(doc => {\n        var _doc$data3, _doc$data4;\n\n        if (doc.exists) name = ((_doc$data3 = doc.data()) === null || _doc$data3 === void 0 ? void 0 : _doc$data3.firstName) + \" \" + ((_doc$data4 = doc.data()) === null || _doc$data4 === void 0 ? void 0 : _doc$data4.lastName);\n      });\n      const docRef = db.collection('Forum').doc(userID).collection('Comments').doc(time.getTime().toString());\n      await docRef.set({\n        id: +docRef.id,\n        entry: entry,\n        posterName: name,\n        posterId: userID,\n        dateTime: time.toLocaleString().replace(/\\//g, \"-\"),\n        deleted: false,\n        reported: false,\n        commentId: +commentId,\n        questionId: +id\n      });\n      const increment = firebase.firestore.FieldValue.increment(1);\n      await db.collection('Forum').doc(commenterId).collection('Comments').doc(commentId).update({\n        noOfReplies: increment\n      });\n    } catch (e) {\n      return console.log(e);\n    } finally {\n      setLoading(false);\n      setShowReplyCommentModal(false);\n      setEntry(\"\");\n    }\n  };\n\n  useEffect(() => {\n    db.collection('Forum').doc(uid).collection('Questions').doc(id).get().then(entry => {\n      if (entry.exists) {\n        var _entry$data, _entry$data2, _entry$data3, _entry$data4, _entry$data5, _entry$data6;\n\n        setQuestion({\n          title: (_entry$data = entry.data()) === null || _entry$data === void 0 ? void 0 : _entry$data.entry,\n          asker: (_entry$data2 = entry.data()) === null || _entry$data2 === void 0 ? void 0 : _entry$data2.posterName,\n          askerId: (_entry$data3 = entry.data()) === null || _entry$data3 === void 0 ? void 0 : _entry$data3.posterId,\n          dateTime: (_entry$data4 = entry.data()) === null || _entry$data4 === void 0 ? void 0 : _entry$data4.dateTime,\n          commentCount: (_entry$data5 = entry.data()) === null || _entry$data5 === void 0 ? void 0 : _entry$data5.noOfComments,\n          removed: (_entry$data6 = entry.data()) === null || _entry$data6 === void 0 ? void 0 : _entry$data6.deleted\n        });\n      }\n    });\n    db.collection('Forum').get().then(uRef => {\n      const comments = [];\n      setComments(comments);\n      uRef.forEach(user => {\n        return db.collection('Forum').doc(user.id).collection('Comments').where(\"questionId\", \"==\", +id).onSnapshot(entries => {\n          entries.docChanges().forEach(change => {\n            comments.unshift({\n              id: +change.doc.id,\n              entry: change.doc.data().entry,\n              dateTime: change.doc.data().dateTime,\n              user: change.doc.data().posterName,\n              uid: change.doc.data().posterId,\n              removed: change.doc.data().deleted,\n              commentId: change.doc.data().commentId || null\n            });\n          });\n        });\n      });\n      console.log(comments);\n      setTimeout(() => {\n        setComments(comments.sort(forumPostsAsc));\n        setLoading(false);\n      }, 500);\n    });\n  }, []); //console.log(comments)\n\n  return /*#__PURE__*/React.createElement(IonPage, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(IonHeader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(TopNav, {\n    title: \"Forum\",\n    route: \"/u/forum\",\n    backarrow: true,\n    hamburger: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(IonContent, {\n    fullscreen: true,\n    id: \"forum-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonGrid, {\n    id: \"forum-searchbar-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(IonRow, {\n    className: \"ion-justify-content-start\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(IonCol, {\n    size: \"10\",\n    className: \"forum-col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: e => {\n      e.preventDefault();\n      history.push(`/u/forumSearch/${keyword}`);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(IonSearchbar, {\n    value: keyword,\n    onIonChange: e => setKeyword(e.detail.value),\n    enterkeyhint: \"search\",\n    id: \"forum-searchbar\",\n    animated: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 33\n    }\n  }))), /*#__PURE__*/React.createElement(IonCol, {\n    size: \"2\",\n    className: \"forum-col ion-align-self-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(ForumRules, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 29\n    }\n  })))), /*#__PURE__*/React.createElement(IonList, {\n    className: \"forum-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(IonGrid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(IonRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(IonLabel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(IonText, {\n    className: \"forum-question\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 39\n    }\n  }, question.removed === false ? question.title : \"[deleted]\"))), /*#__PURE__*/React.createElement(IonRow, {\n    className: \"ion-justify-content-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(IonText, {\n    className: \"forum-question-details\",\n    id: \"forum-userName\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 29\n    }\n  }, \"~ \", question.asker)), /*#__PURE__*/React.createElement(IonRow, {\n    className: \"ion-align-items-end ion-justify-content-start\",\n    id: \"forum-question-detail-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(IonCol, {\n    size: \"1\",\n    className: \"forum-col ion-align-self-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faClock,\n    size: \"sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(IonCol, {\n    size: \"6\",\n    className: \"forum-col ion-align-self-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(IonText, {\n    className: \"forum-question-details\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 33\n    }\n  }, question.dateTime)), /*#__PURE__*/React.createElement(IonCol, {\n    size: \"1\",\n    className: \"forum-col ion-align-self-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faCommentAlt,\n    size: \"sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(IonCol, {\n    size: \"3\",\n    className: \"forum-col ion-align-self-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(IonText, {\n    className: \"forum-question-details\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 33\n    }\n  }, question.commentCount)), /*#__PURE__*/React.createElement(IonCol, {\n    size: \"1\",\n    className: \"ion-align-self-end forum-col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Forum_FlagModal, {\n    disabled: question.removed === false ? false : true,\n    postId: question.id,\n    postType: \"Question\",\n    postContent: question.title,\n    offender: question.asker,\n    offenderId: question.askerId,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 33\n    }\n  }))))), /*#__PURE__*/React.createElement(IonGrid, {\n    id: \"add-comment-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(IonRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(IonCol, {\n    className: \"ion-align-self-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(IonText, {\n    id: \"addComment-commentText\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 29\n    }\n  }, \"Comments\")), /*#__PURE__*/React.createElement(IonCol, {\n    className: \"ion-align-self-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(IonButton, {\n    id: \"forum-addCommentBtn\",\n    size: \"small\",\n    onClick: () => setShowAddCommentModal(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faComment,\n    size: \"sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 33\n    }\n  }), /*#__PURE__*/React.createElement(IonText, {\n    style: {\n      marginLeft: '5%',\n      fontSize: '90%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 33\n    }\n  }, \"Add Comment\"))))), /*#__PURE__*/React.createElement(IonGrid, {\n    id: \"comment-main-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 17\n    }\n  }, comments.length > 0 ? comments.map(post => {\n    if (post.commentId === null) {\n      return /*#__PURE__*/React.createElement(IonList, {\n        id: \"comment-list\",\n        key: post.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(IonGrid, {\n        className: \"forum-container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 41\n        }\n      }, /*#__PURE__*/React.createElement(IonRow, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 45\n        }\n      }, /*#__PURE__*/React.createElement(IonLabel, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 49\n        }\n      }, /*#__PURE__*/React.createElement(IonText, {\n        id: \"comment-text\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 59\n        }\n      }, post.removed === false ? post.entry : \"[deleted]\"))), /*#__PURE__*/React.createElement(IonRow, {\n        className: \"ion-justify-content-end\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 45\n        }\n      }, /*#__PURE__*/React.createElement(IonText, {\n        id: \"comment-userName\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 49\n        }\n      }, \"~ \", post.user)), /*#__PURE__*/React.createElement(IonRow, {\n        className: \"ion-align-items-end ion-justify-content-start\",\n        id: \"comment-detail-container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 45\n        }\n      }, /*#__PURE__*/React.createElement(IonCol, {\n        size: \"1\",\n        className: \"forum-col ion-align-self-end\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 49\n        }\n      }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n        icon: faClock,\n        size: \"sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 53\n        }\n      })), /*#__PURE__*/React.createElement(IonCol, {\n        size: \"6\",\n        className: \"forum-col ion-align-self-end\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 49\n        }\n      }, /*#__PURE__*/React.createElement(IonText, {\n        id: \"comment-details\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 53\n        }\n      }, post.dateTime)), /*#__PURE__*/React.createElement(IonCol, {\n        size: \"4\",\n        className: \"forum-col ion-align-self-end\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 49\n        }\n      }, question.askerId === userID || post.uid === userID ? /*#__PURE__*/React.createElement(IonButton, {\n        onClick: () => [setShowReplyCommentModal(true), setCommentDetails({\n          commenter: post.user,\n          commentId: post.id,\n          commenterId: post.uid\n        })],\n        id: \"comment-replyBtn\",\n        size: \"small\",\n        disabled: post.removed === false ? false : true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 57\n        }\n      }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n        icon: faCommentDots,\n        size: \"sm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 61\n        }\n      }), /*#__PURE__*/React.createElement(IonText, {\n        style: {\n          marginLeft: '5%'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 61\n        }\n      }, \"Reply\")) : null), /*#__PURE__*/React.createElement(IonCol, {\n        size: \"1\",\n        className: \"ion-align-self-end forum-col\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 49\n        }\n      }, /*#__PURE__*/React.createElement(Forum_FlagModal, {\n        disabled: post.removed === false ? false : true,\n        postId: post.id,\n        postType: \"Comment\",\n        postContent: post.entry,\n        offender: post.user,\n        offenderId: post.uid,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 53\n        }\n      })))), comments.map(reply => {\n        if (reply.commentId === post.id) {\n          return /*#__PURE__*/React.createElement(IonGrid, {\n            className: \"forum-container\",\n            id: \"comment-reply-container\",\n            key: reply.id,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 53\n            }\n          }, /*#__PURE__*/React.createElement(IonRow, {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 57\n            }\n          }, /*#__PURE__*/React.createElement(IonLabel, {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 61\n            }\n          }, /*#__PURE__*/React.createElement(IonText, {\n            id: \"comment-text\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 65\n            }\n          }, reply.entry))), /*#__PURE__*/React.createElement(IonRow, {\n            className: \"ion-justify-content-end\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 57\n            }\n          }, /*#__PURE__*/React.createElement(IonText, {\n            id: \"comment-userName\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 267,\n              columnNumber: 61\n            }\n          }, \"~ \", reply.user)), /*#__PURE__*/React.createElement(IonRow, {\n            className: \"ion-align-items-end ion-justify-content-start\",\n            id: \"comment-detail-container\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 57\n            }\n          }, /*#__PURE__*/React.createElement(IonCol, {\n            size: \"1\",\n            className: \"forum-col ion-align-self-end\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 61\n            }\n          }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n            icon: faClock,\n            size: \"sm\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 65\n            }\n          })), /*#__PURE__*/React.createElement(IonCol, {\n            size: \"10\",\n            className: \"forum-col ion-align-self-end\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 273,\n              columnNumber: 61\n            }\n          }, /*#__PURE__*/React.createElement(IonText, {\n            id: \"comment-details\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 65\n            }\n          }, reply.dateTime)), /*#__PURE__*/React.createElement(IonCol, {\n            size: \"1\",\n            className: \"ion-align-self-end forum-col\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 61\n            }\n          }, /*#__PURE__*/React.createElement(Forum_FlagModal, {\n            disabled: false,\n            postId: reply.id,\n            postType: \"Reply\",\n            postContent: reply.entry,\n            offender: reply.user,\n            offenderId: reply.uid,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 65\n            }\n          }))));\n        }\n      }));\n    }\n  }) : /*#__PURE__*/React.createElement(IonGrid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(IonRow, {\n    className: \"ion-justify-content-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(IonText, {\n    color: \"medium\",\n    id: \"no-comment-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 33\n    }\n  }, \"There are currently no comments for this part.\")))), /*#__PURE__*/React.createElement(IonModal, {\n    isOpen: showAddCommentModal,\n    cssClass: \"post-question-modal\",\n    onDidDismiss: () => setShowAddCommentModal(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(IonContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(IonGrid, {\n    id: \"postQns-modal-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(IonRow, {\n    style: {\n      paddingTop: '1%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(IonLabel, {\n    id: \"postQns-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 33\n    }\n  }, \"Add Comment\")), /*#__PURE__*/React.createElement(IonItemDivider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(IonRow, {\n    id: \"postQns-modal-inputArea\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(IonTextarea, {\n    value: entry,\n    onIonChange: e => setEntry(e.detail.value),\n    rows: 11,\n    contentEditable: true,\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(IonRow, {\n    className: \"ion-justify-content-around\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(IonButton, {\n    id: \"postQns-close-button\",\n    fill: \"outline\",\n    onClick: () => setShowAddCommentModal(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 33\n    }\n  }, \"CANCEL\"), /*#__PURE__*/React.createElement(IonButton, {\n    id: \"postQns-post-button\",\n    onClick: handleComment,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 33\n    }\n  }, \"COMMENT\"))))), /*#__PURE__*/React.createElement(IonModal, {\n    isOpen: showReplyCommentModal,\n    cssClass: \"post-question-modal\",\n    onDidDismiss: () => setShowReplyCommentModal(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(IonContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(IonGrid, {\n    id: \"postQns-modal-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(IonRow, {\n    style: {\n      paddingTop: '1%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(IonLabel, {\n    id: \"postQns-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 33\n    }\n  }, \"Reply to \", commentDetails.commenter, \"'s comment\")), /*#__PURE__*/React.createElement(IonItemDivider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(IonRow, {\n    id: \"postQns-modal-inputArea\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(IonTextarea, {\n    value: entry,\n    onIonChange: e => setEntry(e.detail.value),\n    rows: 11,\n    contentEditable: true,\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(IonRow, {\n    className: \"ion-justify-content-around\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(IonButton, {\n    id: \"postQns-close-button\",\n    fill: \"outline\",\n    onClick: () => setShowReplyCommentModal(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 33\n    }\n  }, \"CANCEL\"), /*#__PURE__*/React.createElement(IonButton, {\n    id: \"postQns-post-button\",\n    onClick: () => handleReply(commentDetails.commentId.toString(), commentDetails.commenterId.toString()),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 33\n    }\n  }, \"COMMENT\"))))), /*#__PURE__*/React.createElement(IonLoading, {\n    isOpen: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 17\n    }\n  })));\n};\n\nexport default ForumViewQuestion;","map":{"version":3,"sources":["D:/BearBear/Coding_Projects/UOW-CSIT321 (FYP)/FYP20S313-Mobile/SIM-OpenHouse/src/pages/Forum/ForumViewQuestion.tsx"],"names":["IonContent","IonPage","IonGrid","IonRow","IonSearchbar","IonCol","IonList","IonLabel","IonText","IonHeader","IonLoading","IonButton","IonItemDivider","IonModal","IonTextarea","React","useEffect","useState","useHistory","useParams","FontAwesomeIcon","faClock","faComment","faCommentAlt","faCommentDots","firebase","TopNav","ForumRules","Forum_FlagModal","db","useAuth","forumPostsAsc","ForumViewQuestion","id","uid","userID","history","loading","setLoading","showAddCommentModal","setShowAddCommentModal","showReplyCommentModal","setShowReplyCommentModal","question","setQuestion","entry","setEntry","comments","setComments","commentDetails","setCommentDetails","commenter","commentId","commenterId","keyword","setKeyword","handleComment","time","Date","name","collection","doc","get","then","exists","data","firstName","lastName","docRef","getTime","toString","set","questionId","posterName","posterId","dateTime","toLocaleString","replace","deleted","reported","noOfReplies","increment","firestore","FieldValue","update","noOfComments","e","console","log","handleReply","title","asker","askerId","commentCount","removed","uRef","forEach","user","where","onSnapshot","entries","docChanges","change","unshift","setTimeout","sort","preventDefault","push","detail","value","marginLeft","fontSize","length","map","post","reply","paddingTop"],"mappings":"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","sourcesContent":["import { IonContent, IonPage, IonGrid, IonRow, IonSearchbar, IonCol, IonList, IonLabel, IonText, IonHeader, IonLoading, IonButton, IonItemDivider, IonModal, IonTextarea } from '@ionic/react';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useHistory, useParams } from 'react-router';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faClock, faComment, faCommentAlt, faCommentDots } from '@fortawesome/free-regular-svg-icons';\r\nimport firebase from 'firebase';\r\n\r\nimport '../../css/Global.css';\r\nimport '../../css/Forum.css';\r\nimport TopNav from '../../components/TopNav';\r\nimport ForumRules from '../../components/Forum/ForumRules';\r\nimport Forum_FlagModal from '../../components/Forum/Forum_FlagModal';\r\nimport { db } from '../../firebase';\r\nimport { useAuth } from '../../modules/auth';\r\nimport { forumPostsAsc } from '../../modules/compare';\r\n\r\ninterface RouteParams {\r\n    id: string;\r\n    uid: string;\r\n}\r\n\r\nconst ForumViewQuestion: React.FC = () => {\r\n    const { id, uid } = useParams<RouteParams>();\r\n    const { userID } = useAuth();\r\n\r\n    let history = useHistory();\r\n\r\n    const [loading, setLoading] = useState(true);\r\n    const [showAddCommentModal, setShowAddCommentModal] = useState(false);\r\n    const [showReplyCommentModal, setShowReplyCommentModal] = useState(false);\r\n    const [question, setQuestion] = useState<any>({});\r\n    const [entry, setEntry] = useState(\"\");\r\n    const [comments, setComments] = useState([]);\r\n    const [commentDetails, setCommentDetails] = useState({ commenter: \"\", commentId: 0, commenterId: 0 });\r\n    const [keyword, setKeyword] = useState(\"\");\r\n\r\n\r\n    const handleComment = async () => {\r\n        try {\r\n            setLoading(true);\r\n            const time = new Date();\r\n            let name: string;\r\n\r\n            if (entry !== \"\") {\r\n                await db.collection('Students').doc(userID).get().then(doc => {\r\n                    if (doc.exists)\r\n                        name = doc.data()?.firstName + \" \" + doc.data()?.lastName;\r\n                });\r\n\r\n                const docRef = db.collection('Forum').doc(userID).collection('Comments').doc((time.getTime()).toString());\r\n                await docRef.set({\r\n                    id: +docRef.id,\r\n                    entry: entry,\r\n                    questionId: +id,\r\n                    posterName: name!,\r\n                    posterId: userID,\r\n                    dateTime: time.toLocaleString().replace(/\\//g, \"-\"),\r\n                    deleted: false,\r\n                    reported: false,\r\n                    noOfReplies: 0\r\n                });\r\n\r\n                const increment = firebase.firestore.FieldValue.increment(1);\r\n                await db.collection('Forum').doc(uid).collection('Questions').doc(id).update({\r\n                    noOfComments: increment,\r\n                });\r\n            }\r\n        } catch (e) {\r\n            return console.log(e);\r\n        } finally {\r\n            setLoading(false);\r\n            setShowAddCommentModal(false);\r\n            setEntry(\"\");\r\n        }\r\n    }\r\n\r\n    const handleReply = async (commentId: string, commenterId: string) => {\r\n        try {\r\n            setLoading(true);\r\n            const time = new Date();\r\n            let name: string;\r\n\r\n            await db.collection('Students').doc(userID).get().then(doc => {\r\n                if (doc.exists)\r\n                    name = doc.data()?.firstName + \" \" + doc.data()?.lastName;\r\n            });\r\n            \r\n            const docRef = db.collection('Forum').doc(userID).collection('Comments').doc((time.getTime()).toString());\r\n            await docRef.set({\r\n                id: +docRef.id,\r\n                entry: entry,\r\n                posterName: name!,\r\n                posterId: userID,\r\n                dateTime: time.toLocaleString().replace(/\\//g, \"-\"),\r\n                deleted: false,\r\n                reported: false,\r\n                commentId: +commentId,\r\n                questionId: +id\r\n            });\r\n\r\n            const increment = firebase.firestore.FieldValue.increment(1);\r\n            await db.collection('Forum').doc(commenterId).collection('Comments').doc(commentId).update({\r\n                noOfReplies: increment,\r\n            });\r\n        } catch (e) {\r\n            return console.log(e);\r\n        } finally {\r\n            setLoading(false);\r\n            setShowReplyCommentModal(false);\r\n            setEntry(\"\");\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        db.collection('Forum').doc(uid).collection('Questions').doc(id).get().then(entry => {\r\n            if (entry.exists) {\r\n                setQuestion({\r\n                    title: entry.data()?.entry,\r\n                    asker: entry.data()?.posterName,\r\n                    askerId: entry.data()?.posterId,\r\n                    dateTime: entry.data()?.dateTime,\r\n                    commentCount: entry.data()?.noOfComments,\r\n                    removed: entry.data()?.deleted\r\n                });\r\n            }\r\n        });\r\n\r\n        db.collection('Forum').get().then(uRef => {\r\n            const comments: any = [];\r\n            setComments(comments)\r\n\r\n            uRef.forEach(user => {\r\n                return db.collection('Forum').doc(user.id).collection('Comments').where(\"questionId\", \"==\", +id).onSnapshot(entries => {\r\n                    entries.docChanges().forEach(change => {\r\n                        comments.unshift({\r\n                            id: +change.doc.id,\r\n                            entry: change.doc.data().entry,\r\n                            dateTime: change.doc.data().dateTime,\r\n                            user: change.doc.data().posterName,\r\n                            uid: change.doc.data().posterId,\r\n                            removed: change.doc.data().deleted,\r\n                            commentId: change.doc.data().commentId || null\r\n                        });\r\n                    });\r\n                });\r\n            });\r\n\r\n            console.log(comments)\r\n            setTimeout(() => {\r\n                setComments(comments.sort(forumPostsAsc));\r\n                setLoading(false);\r\n            }, 500);\r\n        });\r\n    }, []);\r\n\r\n    //console.log(comments)\r\n    \r\n    return (\r\n        <IonPage>\r\n            <IonHeader>\r\n                <TopNav title=\"Forum\" route=\"/u/forum\" backarrow={ true } hamburger={ true }/>\r\n            </IonHeader>\r\n            \r\n            <IonContent  fullscreen id=\"forum-content\">\r\n                <IonGrid id=\"forum-searchbar-container\">\r\n                    <IonRow className=\"ion-justify-content-start\">\r\n                        <IonCol size=\"10\" className=\"forum-col\">\r\n                            <form onSubmit={e => { e.preventDefault(); history.push(`/u/forumSearch/${keyword}`); }}>\r\n                                <IonSearchbar value={keyword} onIonChange={e => setKeyword(e.detail.value!)} enterkeyhint=\"search\" id=\"forum-searchbar\" animated></IonSearchbar>\r\n                            </form>\r\n                        </IonCol>\r\n                        <IonCol size=\"2\" className=\"forum-col ion-align-self-center\">\r\n                            <ForumRules />\r\n                        </IonCol>\r\n                    </IonRow>\r\n                </IonGrid>\r\n                <IonList className=\"forum-container\">\r\n                    <IonGrid>\r\n                        <IonRow>\r\n                            <IonLabel><IonText className=\"forum-question\">{question.removed === false ? question.title : \"[deleted]\"}</IonText></IonLabel>\r\n                        </IonRow>\r\n                        <IonRow className=\"ion-justify-content-end\">\r\n                            <IonText className=\"forum-question-details\" id=\"forum-userName\">~ {question.asker}</IonText>\r\n                        </IonRow>\r\n                        <IonRow className=\"ion-align-items-end ion-justify-content-start\" id=\"forum-question-detail-container\">\r\n                            <IonCol size=\"1\" className=\"forum-col ion-align-self-end\">\r\n                                <FontAwesomeIcon icon={faClock} size=\"sm\"/>\r\n                            </IonCol>\r\n                            <IonCol size=\"6\" className=\"forum-col ion-align-self-end\">\r\n                                <IonText className=\"forum-question-details\">{question.dateTime}</IonText>\r\n                            </IonCol>\r\n                            <IonCol size=\"1\" className=\"forum-col ion-align-self-end\">\r\n                                <FontAwesomeIcon icon={faCommentAlt} size=\"sm\"/>\r\n                            </IonCol>\r\n                            <IonCol size=\"3\" className=\"forum-col ion-align-self-end\">\r\n                                <IonText className=\"forum-question-details\">{question.commentCount}</IonText>\r\n                            </IonCol>\r\n                            <IonCol size=\"1\" className=\"ion-align-self-end forum-col\">\r\n                                <Forum_FlagModal disabled={question.removed === false ? false : true} postId={question.id} postType={\"Question\"} postContent={question.title} offender={question.asker} offenderId={question.askerId} />\r\n                            </IonCol>\r\n                        </IonRow>\r\n                    </IonGrid>\r\n                </IonList>\r\n\r\n                <IonGrid id=\"add-comment-container\">\r\n                    <IonRow>\r\n                        <IonCol className=\"ion-align-self-center\">\r\n                            <IonText id=\"addComment-commentText\">Comments</IonText>\r\n                        </IonCol>\r\n                        <IonCol className=\"ion-align-self-center\">\r\n                            <IonButton id=\"forum-addCommentBtn\" size=\"small\" onClick={() => setShowAddCommentModal(true)}>\r\n                                <FontAwesomeIcon icon={faComment} size=\"sm\" />\r\n                                <IonText style={{marginLeft: '5%', fontSize: '90%'}}>Add Comment</IonText>\r\n                            </IonButton>\r\n                        </IonCol>\r\n                    </IonRow>\r\n                </IonGrid>\r\n\r\n                {/* COMMENT */}\r\n                <IonGrid id=\"comment-main-container\">\r\n                    { comments.length > 0 ? \r\n                        comments.map((post: any) => {\r\n                            if (post.commentId === null) {\r\n                                return (\r\n                                    <IonList id=\"comment-list\" key={post.id}>\r\n                                        <IonGrid className=\"forum-container\">\r\n                                            <IonRow>\r\n                                                <IonLabel><IonText id=\"comment-text\">{post.removed === false ? post.entry : \"[deleted]\"}</IonText></IonLabel>\r\n                                            </IonRow>\r\n                                            <IonRow className=\"ion-justify-content-end\">\r\n                                                <IonText id=\"comment-userName\">~ {post.user}</IonText>\r\n                                            </IonRow>\r\n                                            <IonRow className=\"ion-align-items-end ion-justify-content-start\" id=\"comment-detail-container\">\r\n                                                <IonCol size=\"1\" className=\"forum-col ion-align-self-end\">\r\n                                                    <FontAwesomeIcon icon={faClock} size=\"sm\"/>\r\n                                                </IonCol>\r\n                                                <IonCol size=\"6\" className=\"forum-col ion-align-self-end\">\r\n                                                    <IonText id=\"comment-details\">{post.dateTime}</IonText>\r\n                                                </IonCol>\r\n                                                <IonCol size=\"4\" className=\"forum-col ion-align-self-end\">\r\n                                                    { (question.askerId === userID! || post.uid === userID!) ?\r\n                                                        <IonButton onClick={() => [setShowReplyCommentModal(true), setCommentDetails({ commenter: post.user, commentId: post.id, commenterId: post.uid })]} id=\"comment-replyBtn\" size=\"small\" disabled={post.removed === false ? false : true}>\r\n                                                            <FontAwesomeIcon icon={faCommentDots} size=\"sm\"/>\r\n                                                            <IonText style={{marginLeft: '5%'}}>Reply</IonText>\r\n                                                        </IonButton>\r\n                                                        :\r\n                                                        null\r\n                                                    }\r\n                                                </IonCol>\r\n                                                <IonCol size=\"1\" className=\"ion-align-self-end forum-col\">\r\n                                                    <Forum_FlagModal disabled={post.removed === false ? false : true} postId={post.id} postType={\"Comment\"} postContent={post.entry} offender={post.user} offenderId={post.uid} />\r\n                                                </IonCol>\r\n                                            </IonRow>\r\n                                        </IonGrid>\r\n\r\n                                        {/* REPLY */}\r\n                                        { comments.map((reply: any) => {\r\n                                            if (reply.commentId === post.id) {\r\n                                                return (\r\n                                                    <IonGrid className=\"forum-container\" id=\"comment-reply-container\" key={reply.id}>\r\n                                                        <IonRow>\r\n                                                            <IonLabel>\r\n                                                                <IonText id=\"comment-text\">{reply.entry}</IonText>\r\n                                                            </IonLabel>\r\n                                                        </IonRow>\r\n                                                        <IonRow className=\"ion-justify-content-end\">\r\n                                                            <IonText id=\"comment-userName\">~ {reply.user}</IonText>\r\n                                                        </IonRow>\r\n                                                        <IonRow className=\"ion-align-items-end ion-justify-content-start\" id=\"comment-detail-container\">\r\n                                                            <IonCol size=\"1\" className=\"forum-col ion-align-self-end\">\r\n                                                                <FontAwesomeIcon icon={faClock} size=\"sm\"/>\r\n                                                            </IonCol>\r\n                                                            <IonCol size=\"10\" className=\"forum-col ion-align-self-end\">\r\n                                                                <IonText id=\"comment-details\">{reply.dateTime}</IonText>\r\n                                                            </IonCol>\r\n                                                            <IonCol size=\"1\" className=\"ion-align-self-end forum-col\">\r\n                                                                <Forum_FlagModal disabled={false} postId={reply.id} postType={\"Reply\"} postContent={reply.entry} offender={reply.user} offenderId={reply.uid} />\r\n                                                            </IonCol>\r\n                                                        </IonRow>\r\n                                                    </IonGrid>\r\n                                                )\r\n                                            }   \r\n                                        })}\r\n                                    </IonList>\r\n                                )\r\n                            }\r\n                        }\r\n                    ) : (\r\n                        <IonGrid>\r\n                            <IonRow className=\"ion-justify-content-center\">\r\n                                <IonText color=\"medium\" id=\"no-comment-text\">There are currently no comments for this part.</IonText>\r\n                            </IonRow>\r\n                        </IonGrid>\r\n                    )}\r\n                </IonGrid>\r\n                <IonModal isOpen={showAddCommentModal} cssClass='post-question-modal' onDidDismiss={() => setShowAddCommentModal(false)}>\r\n                    <IonContent>\r\n                        <IonGrid id=\"postQns-modal-container\">\r\n                            <IonRow style={{paddingTop: '1%'}}>\r\n                                <IonLabel id=\"postQns-title\">Add Comment</IonLabel>\r\n                            </IonRow>\r\n                            <IonItemDivider />\r\n                            <IonRow id=\"postQns-modal-inputArea\">\r\n                                <IonTextarea value={entry} onIonChange={e => setEntry(e.detail.value!)} rows={11} contentEditable={true} required></IonTextarea>\r\n                            </IonRow>\r\n                            <IonRow className=\"ion-justify-content-around\">\r\n                                <IonButton id=\"postQns-close-button\" fill=\"outline\" onClick={() => setShowAddCommentModal(false)}>CANCEL</IonButton>\r\n                                <IonButton id=\"postQns-post-button\" onClick={handleComment}>COMMENT</IonButton>\r\n                            </IonRow>\r\n                        </IonGrid>\r\n                    </IonContent>\r\n                </IonModal>\r\n                <IonModal isOpen={showReplyCommentModal} cssClass='post-question-modal' onDidDismiss={() => setShowReplyCommentModal(false)}>\r\n                    <IonContent>\r\n                        <IonGrid id=\"postQns-modal-container\">\r\n                            <IonRow style={{paddingTop: '1%'}}>\r\n                                <IonLabel id=\"postQns-title\">Reply to {commentDetails.commenter}'s comment</IonLabel>\r\n                            </IonRow>\r\n                            <IonItemDivider />\r\n                            <IonRow id=\"postQns-modal-inputArea\">\r\n                                <IonTextarea value={entry} onIonChange={e => setEntry(e.detail.value!)} rows={11} contentEditable={true} required></IonTextarea>\r\n                            </IonRow>\r\n                            <IonRow className=\"ion-justify-content-around\">\r\n                                <IonButton id=\"postQns-close-button\" fill=\"outline\" onClick={() => setShowReplyCommentModal(false)}>CANCEL</IonButton>\r\n                                <IonButton id=\"postQns-post-button\" onClick={() => handleReply(commentDetails.commentId.toString(), commentDetails.commenterId.toString())}>COMMENT</IonButton>\r\n                            </IonRow>\r\n                        </IonGrid>\r\n                    </IonContent>\r\n                </IonModal>\r\n                <IonLoading isOpen={loading} />\r\n            </IonContent>\r\n        </IonPage>\r\n    );\r\n};\r\n\r\nexport default ForumViewQuestion;"]},"metadata":{},"sourceType":"module"}