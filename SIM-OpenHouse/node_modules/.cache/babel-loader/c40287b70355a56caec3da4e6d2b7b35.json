{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import{IonContent,IonPage,IonButton,IonGrid,IonRow,IonCol,IonInput,IonRouterLink,IonItemDivider,IonLoading,IonAlert,IonText}from'@ionic/react';import React,{useState}from'react';import{Redirect}from'react-router';import{useForm}from\"react-hook-form\";import{useAuth}from'../auth';import{auth,googleProvider}from'../firebase';import firebase from'firebase';import'../css/Login.css';import'../css/Global.css';import TopNav from'../components/TopNav';var Login=function Login(){var _useAuth=useAuth(),loggedIn=_useAuth.loggedIn;var _useState=useState({loading:false,error:false}),_useState2=_slicedToArray(_useState,2),status=_useState2[0],setStatus=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showAlert=_useState4[0],setShowAlert=_useState4[1];var _useState5=useState(\"default\"),_useState6=_slicedToArray(_useState5,2),loginType=_useState6[0],setLoginType=_useState6[1];var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit;var handleLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setStatus({loading:true,error:false});_context.next=4;return auth.setPersistence(firebase.auth.Auth.Persistence.SESSION).then(function(){return auth.signInWithEmailAndPassword(data.email,data.password);}).then(function(user){var _user$user;return(_user$user=user.user)===null||_user$user===void 0?void 0:_user$user.getIdToken();}).then(function(idToken){//console.log(idToken);\nsessionStorage.setItem('token:',idToken);});case 4:setStatus({loading:false,error:false});_context.next=11;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);setStatus({loading:false,error:true});console.log(_context.t0);case 11:;case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function handleLogin(_x){return _ref.apply(this,arguments);};}();var handleGoogleLogin=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return auth.signInWithRedirect(googleProvider).then(function(){return auth.getRedirectResult();}).then(function(result){if(result.credential){//const token = result.credential.accessToken;\n}var user=result.user;});case 3:_context2.next=8;break;case 5:_context2.prev=5;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 8:case\"end\":return _context2.stop();}}},_callee2,null,[[0,5]]);}));return function handleGoogleLogin(){return _ref2.apply(this,arguments);};}();if(loggedIn){return/*#__PURE__*/React.createElement(Redirect,{to:\"/u/home\"});}return/*#__PURE__*/React.createElement(IonPage,{className:\"ionPage\"},/*#__PURE__*/React.createElement(TopNav,{title:\"Login\",route:\"/main\",backarrow:true,hamburger:false}),/*#__PURE__*/React.createElement(IonContent,{fullscreen:true},/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit(handleLogin)},/*#__PURE__*/React.createElement(IonGrid,null,/*#__PURE__*/React.createElement(IonRow,null,/*#__PURE__*/React.createElement(IonCol,null,/*#__PURE__*/React.createElement(IonInput,{required:true,className:\"inputField\",type:\"text\",placeholder:\"Email\",name:\"email\",ref:register,style:{marginTop:\"5%\"}}))),/*#__PURE__*/React.createElement(IonRow,null,/*#__PURE__*/React.createElement(IonCol,null,/*#__PURE__*/React.createElement(IonInput,{required:true,className:\"inputField\",type:\"password\",placeholder:\"Password\",name:\"password\",ref:register}))),/*#__PURE__*/React.createElement(IonRow,{class:\"ion-justify-content-center\"},/*#__PURE__*/React.createElement(IonButton,{id:\"login_loginBtn\",type:\"submit\",onClick:function onClick(){return setShowAlert(true);}},\"LOGIN\")),/*#__PURE__*/React.createElement(IonRow,{class:\"ion-justify-content-center\"},/*#__PURE__*/React.createElement(IonRouterLink,{color:\"medium\",routerLink:\"/forgetPassword1\"},\"Forget Password?\"))),status.error&&/*#__PURE__*/React.createElement(IonAlert,{isOpen:showAlert,onDidDismiss:function onDidDismiss(){return setShowAlert(false);},cssClass:\"alertBox\",header:'Error Occured!',message:'Please enter a valid email and password.',buttons:['OK']})),/*#__PURE__*/React.createElement(IonLoading,{isOpen:status.loading,message:'Loading...'}),/*#__PURE__*/React.createElement(IonGrid,null,/*#__PURE__*/React.createElement(IonItemDivider,null),/*#__PURE__*/React.createElement(IonText,{color:\"medium\"},/*#__PURE__*/React.createElement(\"div\",{className:\"ion-text-center\",style:{marginTop:\"5%\",fontWeight:\"bold\"}},\"OR\")),/*#__PURE__*/React.createElement(IonRow,{class:\"ion-justify-content-center\"},/*#__PURE__*/React.createElement(IonButton,{id:\"login_googleBtn\",type:\"submit\",onClick:function onClick(){return setShowAlert(true);}},\"LOGIN WITH GOOGLE\")),/*#__PURE__*/React.createElement(IonRow,{class:\"ion-justify-content-center\"},/*#__PURE__*/React.createElement(IonButton,{id:\"login_facebookBtn\",type:\"submit\",onClick:function onClick(){return setShowAlert(true);}},\"LOGIN WITH FACEBOOK\")))));};export default Login;","map":{"version":3,"sources":["D:/BearBear/Coding_Projects/UOW-CSIT321 (FYP)/FYP20S313-Mobile/SIM-OpenHouse/src/pages/Login.tsx"],"names":["IonContent","IonPage","IonButton","IonGrid","IonRow","IonCol","IonInput","IonRouterLink","IonItemDivider","IonLoading","IonAlert","IonText","React","useState","Redirect","useForm","useAuth","auth","googleProvider","firebase","TopNav","Login","loggedIn","loading","error","status","setStatus","showAlert","setShowAlert","loginType","setLoginType","register","handleSubmit","handleLogin","data","setPersistence","Auth","Persistence","SESSION","then","signInWithEmailAndPassword","email","password","user","getIdToken","idToken","sessionStorage","setItem","console","log","handleGoogleLogin","signInWithRedirect","getRedirectResult","result","credential","marginTop","fontWeight"],"mappings":"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","sourcesContent":["import { IonContent, IonPage, IonButton, IonGrid, IonRow, IonCol, IonInput, IonRouterLink, IonItemDivider, IonLoading, IonAlert, IonText } from '@ionic/react';\r\nimport React, { useState } from 'react';\r\nimport { Redirect } from 'react-router';\r\nimport { useForm  } from \"react-hook-form\";\r\n\r\nimport { useAuth } from '../auth';\r\nimport { auth, googleProvider } from '../firebase';\r\nimport firebase from 'firebase';\r\nimport '../css/Login.css';\r\nimport '../css/Global.css';\r\n\r\nimport TopNav from '../components/TopNav';\r\n\r\nconst Login: React.FC = () => {\r\n  const { loggedIn } = useAuth();\r\n\r\n  const [status, setStatus] = useState({ loading: false, error: false });\r\n  const [showAlert, setShowAlert] = useState(false);\r\n  const [loginType, setLoginType] = useState(\"default\");\r\n\r\n  const { register, handleSubmit } = useForm();\r\n\r\n  const handleLogin = async (data: any) => {\r\n    try {\r\n      setStatus({ loading: true, error: false });\r\n\r\n      await auth.setPersistence(firebase.auth.Auth.Persistence.SESSION).then(() => {\r\n        return auth.signInWithEmailAndPassword(data.email, data.password);\r\n      }).then(user => {\r\n        return user.user?.getIdToken();\r\n      }).then((idToken: any) => {\r\n        //console.log(idToken);\r\n        sessionStorage.setItem('token:', idToken);\r\n      });\r\n      setStatus({ loading: false, error: false });\r\n    } catch(e) {\r\n      setStatus({ loading: false, error: true });\r\n      console.log(e);\r\n    };\r\n  };\r\n\r\n  const handleGoogleLogin = async () => {\r\n    try {\r\n      await auth.signInWithRedirect(googleProvider).then(() => {\r\n        return auth.getRedirectResult()\r\n      }).then(result => {\r\n        if (result.credential) {\r\n          //const token = result.credential.accessToken;\r\n        }\r\n\r\n        const user = result.user;\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n\r\n  if (loggedIn){\r\n    return <Redirect to=\"/u/home\"/>;\r\n  }\r\n\r\n  return (\r\n    <IonPage className=\"ionPage\">\r\n      <TopNav title=\"Login\" route=\"/main\" backarrow={ true } hamburger = { false }/>\r\n\r\n      <IonContent fullscreen>\r\n        <form onSubmit={handleSubmit(handleLogin)}>\r\n          <IonGrid>\r\n            <IonRow>\r\n              <IonCol>\r\n              <IonInput required className=\"inputField\" type=\"text\" placeholder=\"Email\" name=\"email\" ref={register} style={{marginTop: \"5%\"}}/>\r\n              </IonCol>\r\n            </IonRow>\r\n            <IonRow>\r\n              <IonCol>\r\n              <IonInput required className=\"inputField\" type=\"password\" placeholder=\"Password\" name=\"password\" ref={register} />\r\n              </IonCol>\r\n            </IonRow>\r\n\r\n            <IonRow class=\"ion-justify-content-center\">\r\n              <IonButton id=\"login_loginBtn\" type=\"submit\" onClick={() => setShowAlert(true)}>LOGIN</IonButton>\r\n            </IonRow>\r\n            <IonRow class=\"ion-justify-content-center\">\r\n              <IonRouterLink color=\"medium\" routerLink=\"/forgetPassword1\">Forget Password?</IonRouterLink>\r\n            </IonRow>\r\n          </IonGrid>\r\n          {status.error && <IonAlert isOpen={showAlert} onDidDismiss={() => setShowAlert(false)} cssClass='alertBox' header={'Error Occured!'} message={'Please enter a valid email and password.'} buttons={['OK']}></IonAlert>}\r\n        </form>\r\n        <IonLoading isOpen={status.loading} message={'Loading...'} />\r\n        <IonGrid>\r\n          <IonItemDivider></IonItemDivider>\r\n          <IonText color=\"medium\"><div className=\"ion-text-center\" style={{marginTop: \"5%\", fontWeight: \"bold\"}}>OR</div></IonText>\r\n          <IonRow class=\"ion-justify-content-center\">\r\n            <IonButton id=\"login_googleBtn\" type=\"submit\" onClick={() => setShowAlert(true)}>LOGIN WITH GOOGLE</IonButton>\r\n          </IonRow>\r\n          <IonRow class=\"ion-justify-content-center\">\r\n            <IonButton id=\"login_facebookBtn\" type=\"submit\" onClick={() => setShowAlert(true)}>LOGIN WITH FACEBOOK</IonButton>\r\n          </IonRow>\r\n        </IonGrid>\r\n      </IonContent>\r\n    </IonPage>\r\n  );\r\n};\r\n  \r\n  export default Login;"]},"metadata":{},"sourceType":"module"}