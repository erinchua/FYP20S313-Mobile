{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\BearBear\\\\Coding_Projects\\\\UOW-CSIT321 (FYP)\\\\FYP20S313-Mobile\\\\SIM-OpenHouse\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import{IonContent,IonPage,IonButton,IonGrid,IonRow,IonCol,IonInput,IonRouterLink,IonItemDivider,IonLoading,IonAlert,IonText}from'@ionic/react';import React,{useState}from'react';import{Redirect}from'react-router';import{useForm}from\"react-hook-form\";import{useAuth}from'../auth';import{auth}from'../firebase';import firebase from'firebase';import'../css/Login.css';import'../css/Global.css';import TopNav from'../components/TopNav';var Login=function Login(){var _useAuth=useAuth(),loggedIn=_useAuth.loggedIn;var _useState=useState({loading:false,error:false}),_useState2=_slicedToArray(_useState,2),status=_useState2[0],setStatus=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showAlert=_useState4[0],setShowAlert=_useState4[1];var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit;var handleLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setStatus({loading:true,error:false});_context.next=4;return auth.setPersistence(firebase.auth.Auth.Persistence.SESSION).then(function(){return auth.signInWithEmailAndPassword(data.email,data.password);}).then(function(user){var _user$user;return(_user$user=user.user)===null||_user$user===void 0?void 0:_user$user.getIdToken();}).then(function(idToken){//console.log(idToken);\nsessionStorage.setItem('token:',idToken);});case 4:setStatus({loading:false,error:false});_context.next=11;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);setStatus({loading:false,error:true});console.log(_context.t0);case 11:;case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function handleLogin(_x){return _ref.apply(this,arguments);};}();if(loggedIn){return/*#__PURE__*/React.createElement(Redirect,{to:\"/u/home\"});}return/*#__PURE__*/React.createElement(IonPage,{className:\"ionPage\"},/*#__PURE__*/React.createElement(TopNav,{title:\"Login\",route:\"/main\",backarrow:true,hamburger:false}),/*#__PURE__*/React.createElement(IonContent,{fullscreen:true},/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit(handleLogin)},/*#__PURE__*/React.createElement(IonGrid,null,/*#__PURE__*/React.createElement(IonRow,null,/*#__PURE__*/React.createElement(IonCol,null,/*#__PURE__*/React.createElement(IonInput,{required:true,className:\"inputField\",type:\"text\",placeholder:\"Email\",name:\"email\",ref:register,style:{marginTop:\"5%\"}}))),/*#__PURE__*/React.createElement(IonRow,null,/*#__PURE__*/React.createElement(IonCol,null,/*#__PURE__*/React.createElement(IonInput,{required:true,className:\"inputField\",type:\"password\",placeholder:\"Password\",name:\"password\",ref:register}))),/*#__PURE__*/React.createElement(IonRow,{class:\"ion-justify-content-center\"},/*#__PURE__*/React.createElement(IonButton,{id:\"login_loginBtn\",type:\"submit\",onClick:function onClick(){return setShowAlert(true);}},\"LOGIN\")),/*#__PURE__*/React.createElement(IonRow,{class:\"ion-justify-content-center\"},/*#__PURE__*/React.createElement(IonRouterLink,{color:\"medium\",routerLink:\"/forgetPassword1\"},\"Forget Password?\")),/*#__PURE__*/React.createElement(IonItemDivider,null),/*#__PURE__*/React.createElement(IonText,{color:\"medium\"},/*#__PURE__*/React.createElement(\"div\",{className:\"ion-text-center\",style:{marginTop:\"5%\",fontWeight:\"bold\"}},\"OR\"))),status.error&&/*#__PURE__*/React.createElement(IonAlert,{isOpen:showAlert,onDidDismiss:function onDidDismiss(){return setShowAlert(false);},cssClass:\"alertBox\",header:'Error Occured!',message:'Please enter a valid email and password.',buttons:['OK']})),/*#__PURE__*/React.createElement(IonLoading,{isOpen:status.loading,message:'Loading...'})));};export default Login;","map":{"version":3,"sources":["D:/BearBear/Coding_Projects/UOW-CSIT321 (FYP)/FYP20S313-Mobile/SIM-OpenHouse/src/pages/Login.tsx"],"names":["IonContent","IonPage","IonButton","IonGrid","IonRow","IonCol","IonInput","IonRouterLink","IonItemDivider","IonLoading","IonAlert","IonText","React","useState","Redirect","useForm","useAuth","auth","firebase","TopNav","Login","loggedIn","loading","error","status","setStatus","showAlert","setShowAlert","register","handleSubmit","handleLogin","data","setPersistence","Auth","Persistence","SESSION","then","signInWithEmailAndPassword","email","password","user","getIdToken","idToken","sessionStorage","setItem","console","log","marginTop","fontWeight"],"mappings":"omBAAA,OAASA,UAAT,CAAgCC,OAAhC,CAA2EC,SAA3E,CAA+FC,OAA/F,CAAwGC,MAAxG,CAAgHC,MAAhH,CAAwHC,QAAxH,CAAkIC,aAAlI,CAAiJC,cAAjJ,CAAiKC,UAAjK,CAA6KC,QAA7K,CAAuLC,OAAvL,KAAsM,cAAtM,CACA,MAAOC,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,QAAT,KAAyB,cAAzB,CACA,OAASC,OAAT,KAAyB,iBAAzB,CAEA,OAASC,OAAT,KAAwB,SAAxB,CACA,OAASC,IAAT,KAAqB,aAArB,CACA,MAAOC,CAAAA,QAAP,KAAqB,UAArB,CACA,MAAO,kBAAP,CACA,MAAO,mBAAP,CAEA,MAAOC,CAAAA,MAAP,KAAmB,sBAAnB,CAEA,GAAMC,CAAAA,KAAe,CAAG,QAAlBA,CAAAA,KAAkB,EAAM,cACPJ,OAAO,EADA,CACpBK,QADoB,UACpBA,QADoB,eAGAR,QAAQ,CAAC,CAAES,OAAO,CAAE,KAAX,CAAkBC,KAAK,CAAE,KAAzB,CAAD,CAHR,wCAGrBC,MAHqB,eAGbC,SAHa,8BAIMZ,QAAQ,CAAC,KAAD,CAJd,yCAIrBa,SAJqB,eAIVC,YAJU,4BAMOZ,OAAO,EANd,CAMpBa,QANoB,UAMpBA,QANoB,CAMVC,YANU,UAMVA,YANU,CAQ5B,GAAMC,CAAAA,WAAW,0FAAG,iBAAOC,IAAP,kIAEhBN,SAAS,CAAC,CAAEH,OAAO,CAAE,IAAX,CAAiBC,KAAK,CAAE,KAAxB,CAAD,CAAT,CAFgB,sBAIVN,CAAAA,IAAI,CAACe,cAAL,CAAoBd,QAAQ,CAACD,IAAT,CAAcgB,IAAd,CAAmBC,WAAnB,CAA+BC,OAAnD,EAA4DC,IAA5D,CAAiE,UAAM,CAC3E,MAAOnB,CAAAA,IAAI,CAACoB,0BAAL,CAAgCN,IAAI,CAACO,KAArC,CAA4CP,IAAI,CAACQ,QAAjD,CAAP,CACD,CAFK,EAEHH,IAFG,CAEE,SAAAI,IAAI,CAAI,gBACd,kBAAOA,IAAI,CAACA,IAAZ,qCAAO,WAAWC,UAAX,EAAP,CACD,CAJK,EAIHL,IAJG,CAIE,SAACM,OAAD,CAAkB,CACxB;AACAC,cAAc,CAACC,OAAf,CAAuB,QAAvB,CAAiCF,OAAjC,EACD,CAPK,CAJU,QAYhBjB,SAAS,CAAC,CAAEH,OAAO,CAAE,KAAX,CAAkBC,KAAK,CAAE,KAAzB,CAAD,CAAT,CAZgB,+EAchBE,SAAS,CAAC,CAAEH,OAAO,CAAE,KAAX,CAAkBC,KAAK,CAAE,IAAzB,CAAD,CAAT,CACAsB,OAAO,CAACC,GAAR,cAfgB,QAgBjB,CAhBiB,oEAAH,kBAAXhB,CAAAA,WAAW,4CAAjB,CAmBA,GAAIT,QAAJ,CAAa,CACX,mBAAO,oBAAC,QAAD,EAAU,EAAE,CAAC,SAAb,EAAP,CACD,CAED,mBACE,oBAAC,OAAD,EAAS,SAAS,CAAC,SAAnB,eACE,oBAAC,MAAD,EAAQ,KAAK,CAAC,OAAd,CAAsB,KAAK,CAAC,OAA5B,CAAoC,SAAS,CAAG,IAAhD,CAAuD,SAAS,CAAK,KAArE,EADF,cAGE,oBAAC,UAAD,EAAY,UAAU,KAAtB,eACE,4BAAM,QAAQ,CAAEQ,YAAY,CAACC,WAAD,CAA5B,eACE,oBAAC,OAAD,mBACE,oBAAC,MAAD,mBACE,oBAAC,MAAD,mBACA,oBAAC,QAAD,EAAU,QAAQ,KAAlB,CAAmB,SAAS,CAAC,YAA7B,CAA0C,IAAI,CAAC,MAA/C,CAAsD,WAAW,CAAC,OAAlE,CAA0E,IAAI,CAAC,OAA/E,CAAuF,GAAG,CAAEF,QAA5F,CAAsG,KAAK,CAAE,CAACmB,SAAS,CAAE,IAAZ,CAA7G,EADA,CADF,CADF,cAME,oBAAC,MAAD,mBACE,oBAAC,MAAD,mBACA,oBAAC,QAAD,EAAU,QAAQ,KAAlB,CAAmB,SAAS,CAAC,YAA7B,CAA0C,IAAI,CAAC,UAA/C,CAA0D,WAAW,CAAC,UAAtE,CAAiF,IAAI,CAAC,UAAtF,CAAiG,GAAG,CAAEnB,QAAtG,EADA,CADF,CANF,cAYE,oBAAC,MAAD,EAAQ,KAAK,CAAC,4BAAd,eACE,oBAAC,SAAD,EAAW,EAAE,CAAC,gBAAd,CAA+B,IAAI,CAAC,QAApC,CAA6C,OAAO,CAAE,yBAAMD,CAAAA,YAAY,CAAC,IAAD,CAAlB,EAAtD,UADF,CAZF,cAeE,oBAAC,MAAD,EAAQ,KAAK,CAAC,4BAAd,eACE,oBAAC,aAAD,EAAe,KAAK,CAAC,QAArB,CAA8B,UAAU,CAAC,kBAAzC,qBADF,CAfF,cAkBE,oBAAC,cAAD,MAlBF,cAmBE,oBAAC,OAAD,EAAS,KAAK,CAAC,QAAf,eAAwB,2BAAK,SAAS,CAAC,iBAAf,CAAiC,KAAK,CAAE,CAACoB,SAAS,CAAE,IAAZ,CAAkBC,UAAU,CAAE,MAA9B,CAAxC,OAAxB,CAnBF,CADF,CAsBGxB,MAAM,CAACD,KAAP,eAAgB,oBAAC,QAAD,EAAU,MAAM,CAAEG,SAAlB,CAA6B,YAAY,CAAE,8BAAMC,CAAAA,YAAY,CAAC,KAAD,CAAlB,EAA3C,CAAsE,QAAQ,CAAC,UAA/E,CAA0F,MAAM,CAAE,gBAAlG,CAAoH,OAAO,CAAE,0CAA7H,CAAyK,OAAO,CAAE,CAAC,IAAD,CAAlL,EAtBnB,CADF,cAyBE,oBAAC,UAAD,EAAY,MAAM,CAAEH,MAAM,CAACF,OAA3B,CAAoC,OAAO,CAAE,YAA7C,EAzBF,CAHF,CADF,CAiCD,CAhED,CAkEE,cAAeF,CAAAA,KAAf","sourcesContent":["import { IonContent, IonHeader, IonPage, IonTitle, IonToolbar, IonButtons, IonButton, IonIcon, IonGrid, IonRow, IonCol, IonInput, IonRouterLink, IonItemDivider, IonLoading, IonAlert, IonText } from '@ionic/react';\r\nimport React, { useState } from 'react';\r\nimport { Redirect } from 'react-router';\r\nimport { useForm  } from \"react-hook-form\";\r\n\r\nimport { useAuth } from '../auth';\r\nimport { auth } from '../firebase';\r\nimport firebase from 'firebase';\r\nimport '../css/Login.css';\r\nimport '../css/Global.css';\r\n\r\nimport TopNav from '../components/TopNav';\r\n\r\nconst Login: React.FC = () => {\r\n  const { loggedIn } = useAuth();\r\n\r\n  const [status, setStatus] = useState({ loading: false, error: false });\r\n  const [showAlert, setShowAlert] = useState(false);\r\n\r\n  const { register, handleSubmit } = useForm();\r\n\r\n  const handleLogin = async (data: any) => {\r\n    try {\r\n      setStatus({ loading: true, error: false });\r\n\r\n      await auth.setPersistence(firebase.auth.Auth.Persistence.SESSION).then(() => {\r\n        return auth.signInWithEmailAndPassword(data.email, data.password);\r\n      }).then(user => {\r\n        return user.user?.getIdToken();\r\n      }).then((idToken: any) => {\r\n        //console.log(idToken);\r\n        sessionStorage.setItem('token:', idToken);\r\n      });\r\n      setStatus({ loading: false, error: false });\r\n    } catch(e) {\r\n      setStatus({ loading: false, error: true });\r\n      console.log(e);\r\n    };\r\n  };\r\n\r\n  if (loggedIn){\r\n    return <Redirect to=\"/u/home\"/>;\r\n  }\r\n\r\n  return (\r\n    <IonPage className=\"ionPage\">\r\n      <TopNav title=\"Login\" route=\"/main\" backarrow={ true } hamburger = { false }/>\r\n\r\n      <IonContent fullscreen>\r\n        <form onSubmit={handleSubmit(handleLogin)}>\r\n          <IonGrid>\r\n            <IonRow>\r\n              <IonCol>\r\n              <IonInput required className=\"inputField\" type=\"text\" placeholder=\"Email\" name=\"email\" ref={register} style={{marginTop: \"5%\"}}/>\r\n              </IonCol>\r\n            </IonRow>\r\n            <IonRow>\r\n              <IonCol>\r\n              <IonInput required className=\"inputField\" type=\"password\" placeholder=\"Password\" name=\"password\" ref={register} />\r\n              </IonCol>\r\n            </IonRow>\r\n\r\n            <IonRow class=\"ion-justify-content-center\">\r\n              <IonButton id=\"login_loginBtn\" type=\"submit\" onClick={() => setShowAlert(true)}>LOGIN</IonButton>\r\n            </IonRow>\r\n            <IonRow class=\"ion-justify-content-center\">\r\n              <IonRouterLink color=\"medium\" routerLink=\"/forgetPassword1\">Forget Password?</IonRouterLink>\r\n            </IonRow>\r\n            <IonItemDivider></IonItemDivider>\r\n            <IonText color=\"medium\"><div className=\"ion-text-center\" style={{marginTop: \"5%\", fontWeight: \"bold\"}}>OR</div></IonText>\r\n          </IonGrid>\r\n          {status.error && <IonAlert isOpen={showAlert} onDidDismiss={() => setShowAlert(false)} cssClass='alertBox' header={'Error Occured!'} message={'Please enter a valid email and password.'} buttons={['OK']}></IonAlert>}\r\n        </form>\r\n        <IonLoading isOpen={status.loading} message={'Loading...'} />\r\n      </IonContent>\r\n    </IonPage>\r\n  );\r\n};\r\n  \r\n  export default Login;"]},"metadata":{},"sourceType":"module"}